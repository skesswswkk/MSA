"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8612],{75809:(e,s,t)=>{t.d(s,{f:()=>m});var a=t(68404),n=t(7197),r=t(68374),i=t(64850),o=t(81135),d=t(97928),l=t(45916);const m=e=>{let{teamId:s,roleOptions:t,disabled:m,onApplyRoles:c,pendingRoles:h,apply:u=!1,maxWidth:p}=e;const[{loading:g,value:b=[]},x]=(0,n.Z)((async()=>{try{if(u&&Boolean(null==h?void 0:h.length))return h;if(r.Vt.hasPermission(i.bW.ActionTeamsRolesList))return await(0,d._C)(s)}catch(e){console.error("Error loading options",e)}return[]}),[s,h]);(0,a.useEffect)((()=>{x()}),[s,x,h]);const f=r.Vt.hasPermission(i.bW.ActionTeamsRolesAdd)&&r.Vt.hasPermission(i.bW.ActionTeamsRolesRemove);return(0,l.jsx)(o.I,{apply:u,onRolesChange:async e=>{u?c&&c(e):(await(0,d.u7)(e,s),await x())},roleOptions:t,appliedRoles:b,isLoading:g,disabled:m,basicRoleDisabled:!0,canUpdateRoles:f,maxWidth:p})}},55801:(e,s,t)=>{t.d(s,{C:()=>d});var a=t(68404),n=t(25981),r=t(68374),i=t(64850),o=t(97928);const d=e=>{const[s,t]=(0,a.useState)(e),{value:d=[]}=(0,n.Z)((async()=>r.Vt.licensedAccessControlEnabled()&&r.Vt.hasPermission(i.bW.ActionRolesList)?(0,o.ul)(s):Promise.resolve([])),[s]);return[{roleOptions:d},t]}},62232:(e,s,t)=>{t.d(s,{Z:()=>N,v:()=>M});var a,n,r,i,o=t(52423),d=t(68404),l=t(54316),m=t(25004),c=t(65737),h=t(3218),u=t(71980),p=t(65678),g=t(37625),b=t(83744),x=t(82261),f=t(48239),j=t(14402),v=t(70917),y=t(8006),T=t(50191),A=t(71438),C=t(35448),w=t(89103),I=t(13498),P=t(45916);function S(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}const L=[{value:"",label:(0,C.t)("shared-preferences.theme.default-label","Default")},{value:"dark",label:(0,C.t)("shared-preferences.theme.dark-label","Dark")},{value:"light",label:(0,C.t)("shared-preferences.theme.light-label","Light")}];const k=Boolean(c.v.featureToggles.internationalization);class M extends d.PureComponent{constructor(e){super(e),S(this,"service",void 0),S(this,"onSubmitForm",(async()=>{if(!this.props.onConfirm||await this.props.onConfirm()){const{homeDashboardUID:e,theme:s,timezone:t,weekStart:a,locale:n,queryHistory:r}=this.state;await this.service.update({homeDashboardUID:e,theme:s,timezone:t,weekStart:a,locale:n,queryHistory:r}),window.location.reload()}})),S(this,"onThemeChanged",(e=>{this.setState({theme:e})})),S(this,"onTimeZoneChanged",(e=>{e&&this.setState({timezone:e})})),S(this,"onWeekStartChanged",(e=>{this.setState({weekStart:e})})),S(this,"onHomeDashboardChanged",(e=>{this.setState({homeDashboardUID:e})})),S(this,"onLocaleChanged",(e=>{this.setState({locale:e})})),this.service=new I.y(e.resourceUri),this.state={theme:"",timezone:"",weekStart:"",locale:"",queryHistory:{homeTab:""}}}async componentDidMount(){const e=await this.service.load();this.setState({homeDashboardUID:e.homeDashboardUID,theme:e.theme,timezone:e.timezone,weekStart:e.weekStart,locale:e.locale,queryHistory:e.queryHistory})}render(){const{theme:e,timezone:s,weekStart:t,homeDashboardUID:o,locale:d}=this.state,{disabled:c}=this.props,T=U(),I=function(){const e=w.lE.map((e=>({value:e.code,label:e.name})));return[{value:"",label:(0,C.t)("common.locale.default","Default")},...e]}();return(0,P.jsx)(h.l,{onSubmit:this.onSubmitForm,children:()=>{var h;return(0,P.jsxs)(u.C,{label:a||(a=(0,P.jsx)(C.cC,{i18nKey:"shared-preferences.title",children:"Preferences"})),disabled:c,children:[(0,P.jsx)(p.g,{label:(0,C.t)("shared-preferences.fields.theme-label","UI Theme"),children:(0,P.jsx)(g.S,{options:L,value:null===(h=L.find((s=>s.value===e)))||void 0===h?void 0:h.value,onChange:this.onThemeChanged})}),(0,P.jsx)(p.g,{label:(0,P.jsx)(b._,{htmlFor:"home-dashboard-select",children:(0,P.jsx)("span",{className:T.labelText,children:n||(n=(0,P.jsx)(C.cC,{i18nKey:"shared-preferences.fields.home-dashboard-label",children:"Home Dashboard"}))})}),"data-testid":"User preferences home dashboard drop down",children:(0,P.jsx)(A.o,{value:o,onChange:e=>{var s;return this.onHomeDashboardChanged(null!==(s=null==e?void 0:e.uid)&&void 0!==s?s:"")},defaultOptions:!0,isClearable:!0,placeholder:(0,C.t)("shared-preferences.fields.home-dashboard-placeholder","Default dashboard"),inputId:"home-dashboard-select"})}),(0,P.jsx)(p.g,{label:(0,C.t)("shared-dashboard.fields.timezone-label","Timezone"),"data-testid":m.wl.components.TimeZonePicker.containerV2,children:(0,P.jsx)(x.O,{includeInternal:!0,value:s,onChange:this.onTimeZoneChanged,inputId:"shared-preferences-timezone-picker"})}),(0,P.jsx)(p.g,{label:(0,C.t)("shared-preferences.fields.week-start-label","Week start"),"data-testid":m.wl.components.WeekStartPicker.containerV2,children:(0,P.jsx)(f.z,{value:t,onChange:this.onWeekStartChanged,inputId:"shared-preferences-week-start-picker"})}),k?(0,P.jsx)(p.g,{label:(0,P.jsxs)(b._,{htmlFor:"locale-select",children:[(0,P.jsx)("span",{className:T.labelText,children:r||(r=(0,P.jsx)(C.cC,{i18nKey:"shared-preferences.fields.locale-label",children:"Language"}))}),(0,P.jsx)(j.a,{featureState:l.CQ.beta})]}),"data-testid":"User preferences language drop down",children:(0,P.jsx)(v.Ph,{value:I.find((e=>e.value===d)),onChange:e=>{var s;return this.onLocaleChanged(null!==(s=e.value)&&void 0!==s?s:"")},options:I,placeholder:(0,C.t)("shared-preferences.fields.locale-placeholder","Choose language"),inputId:"locale-select"})}):null,(0,P.jsx)("div",{className:"gf-form-button-row",children:(0,P.jsx)(y.zx,{type:"submit",variant:"primary","data-testid":m.wl.components.UserProfile.preferencesSaveButton,children:i||(i=(0,P.jsx)(C.cC,{i18nKey:"common.save",children:"Save"}))})})]})}})}}const N=M,U=(0,T.B)((()=>({labelText:o.css`
      margin-right: 6px;
    `})))},89954:(e,s,t)=>{t.r(s),t.d(s,{TeamPages:()=>Ne,default:()=>Ue});var a,n,r,i,o,d,l,m=t(82897),c=t(68404),h=t(36635),u=t(72677),p=t(16755),g=t(37417),b=t(36149),x=t(46782),f=t(85829),j=t(59196),v=t(64850),y=t(8006),T=t(99500),A=t(21888),C=t(34117),w=t(46889),I=t(4645),P=t(34393),S=t(26006),L=t(75442),k=t(54168),M=t(2958),N=t(68021),U=t(45916);function R(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}function G(e){return{groups:(0,N.JB)(e.team)}}const V={loadTeamGroups:M.j_,addTeamGroup:M.A_,removeTeamGroup:M.P5},D=((0,h.connect)(G,V),"Sync LDAP, OAuth or SAML groups with your Grafana teams.");class E extends c.PureComponent{constructor(e){super(e),R(this,"onToggleAdding",(()=>{this.setState({isAdding:!this.state.isAdding})})),R(this,"onNewGroupIdChanged",(e=>{this.setState({newGroupId:e.target.value})})),R(this,"onAddGroup",(e=>{e.preventDefault(),this.props.addTeamGroup(this.state.newGroupId),this.setState({isAdding:!1,newGroupId:""})})),R(this,"onRemoveGroup",(e=>{this.props.removeTeamGroup(e.groupId)})),this.state={isAdding:!1,newGroupId:""}}componentDidMount(){this.fetchTeamGroups()}async fetchTeamGroups(){await this.props.loadTeamGroups()}isNewGroupValid(){return this.state.newGroupId.length>1}renderGroup(e){const{isReadOnly:s}=this.props;return(0,U.jsxs)("tr",{children:[(0,U.jsx)("td",{children:e.groupId}),(0,U.jsx)("td",{style:{width:"1%"},children:(0,U.jsx)(y.zx,{size:"sm",variant:"destructive",onClick:()=>this.onRemoveGroup(e),disabled:s,"aria-label":`Remove group ${e.groupId}`,children:a||(a=(0,U.jsx)(T.J,{name:"times"}))})})]},e.groupId)}render(){const{isAdding:e,newGroupId:s}=this.state,{groups:t,isReadOnly:a}=this.props;return(0,U.jsxs)("div",{children:[(0,k.d5)()&&(n||(n=(0,U.jsx)(b.Xz,{featureId:"team-sync",eventVariant:"trial",featureName:"team sync",text:"Add a group to enable team sync for free during your trial of Grafana Pro."}))),(0,U.jsxs)("div",{className:"page-action-bar",children:[(!(0,k.d5)()||t.length>0)&&(0,U.jsxs)(U.Fragment,{children:[r||(r=(0,U.jsx)("h3",{className:"page-sub-heading",children:"External group sync"})),i||(i=(0,U.jsx)(A.u,{placement:"auto",content:D,children:(0,U.jsx)(T.J,{className:"icon--has-hover page-sub-heading-icon",name:"question-circle"})}))]}),o||(o=(0,U.jsx)("div",{className:"page-action-bar__spacer"})),t.length>0&&(0,U.jsxs)(y.zx,{className:"pull-right",onClick:this.onToggleAdding,disabled:a,children:[d||(d=(0,U.jsx)(T.J,{name:"plus"}))," Add group"]})]}),(0,U.jsx)(P.s,{in:e,children:(0,U.jsxs)("div",{className:"cta-form",children:[(0,U.jsx)(S.P,{onClick:this.onToggleAdding}),(0,U.jsx)("form",{onSubmit:this.onAddGroup,children:(0,U.jsxs)(C.Z,{children:[(0,U.jsx)(w._,{label:"Add External Group",tooltip:"LDAP Group Example: cn=users,ou=groups,dc=grafana,dc=org.",children:(0,U.jsx)(I.I,{type:"text",id:"add-external-group",placeholder:"",value:s,onChange:this.onNewGroupIdChanged,disabled:a})}),(0,U.jsx)(y.zx,{type:"submit",disabled:a||!this.isNewGroupValid(),style:{marginLeft:4},children:"Add group"})]})})]})}),0===t.length&&!e&&((0,k.d5)()?(0,U.jsx)($,{action:{onClick:this.onToggleAdding,text:"Add group"}}):(0,U.jsx)(L.Z,{onClick:this.onToggleAdding,buttonIcon:"users-alt",title:"There are no external groups to sync with",buttonTitle:"Add group",proTip:D,proTipLinkTitle:"Learn more",proTipLink:"https://docs.grafana.org/auth/enhanced_ldap/",proTipTarget:"_blank",buttonDisabled:a})),t.length>0&&(0,U.jsx)("div",{className:"admin-list-table",children:(0,U.jsxs)("table",{className:"filter-table filter-table--hover form-inline",children:[(0,U.jsx)("thead",{children:(0,U.jsxs)("tr",{children:[l||(l=(0,U.jsx)("th",{children:"External Group ID"})),(0,U.jsx)("th",{style:{width:"1%"}})]})}),(0,U.jsx)("tbody",{children:t.map((e=>this.renderGroup(e)))})]})})]})}}const $=e=>{let{action:s}=e;const t=(0,p.l4)();return(0,U.jsx)(b.TA,{action:s,listItems:["Stop managing user access in two places - assign users to groups in SAML, LDAP or Oauth, and manage access at a Team level in Grafana","Update usersâ€™ permissions immediately when you add or remove them from an LDAP group, with no need for them to sign out and back in"],image:`team-sync-${t.isLight?"light":"dark"}.png`,featureName:"team sync",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/team-sync",description:"Team Sync makes it easier for you to manage usersâ€™ access in Grafana, by immediately updating each userâ€™s Grafana teams and permissions based on their single sign-on group membership, instead of when users sign in."})},z=(0,h.connect)(G,V)(E);var W=t(39106),O=t(83744),_=t(15082),Z=t(69980);const Q=e=>{let{featureToggle:s,children:t}=e;return!0===s?(0,U.jsx)(U.Fragment,{children:t}):null};var H,q=t(70917),F=t(77772);const B={removeTeamMember:M.zT,updateTeamMember:M.zZ},J=(0,h.connect)(null,B);class K extends c.PureComponent{constructor(e){var s,t,a;super(e),a=(e,s)=>{const t=e.value,a=Object.assign({},s,{permission:t});this.props.updateTeamMember(a)},(t="onPermissionChange")in(s=this)?Object.defineProperty(s,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[t]=a,this.renderLabels=this.renderLabels.bind(this),this.renderPermissions=this.renderPermissions.bind(this)}onRemoveMember(e){this.props.removeTeamMember(e.userId)}renderPermissions(e){const{editorsCanAdmin:s,signedInUserIsTeamAdmin:t}=this.props,a=v.eL.find((s=>s.value===e.permission));return(0,U.jsx)(Q,{featureToggle:s,children:(0,U.jsx)("td",{className:"width-5 team-permissions",children:t?(0,U.jsx)(q.Ph,{isSearchable:!1,options:v.eL,onChange:s=>this.onPermissionChange(s,e),value:a,width:32,"aria-label":`Select member's ${e.name} permission level`}):(0,U.jsx)("span",{children:a.label})})})}renderLabels(e){return e?(0,U.jsx)("td",{children:e.map((e=>(0,U.jsx)(Z.e,{label:e,removeIcon:!1,count:0},e)))}):H||(H=(0,U.jsx)("td",{}))}render(){const{member:e,syncEnabled:s,signedInUserIsTeamAdmin:t}=this.props;return(0,U.jsxs)("tr",{children:[(0,U.jsx)("td",{className:"width-4 text-center",children:(0,U.jsx)("img",{alt:`Avatar for team member "${e.name}"`,className:"filter-table__avatar",src:e.avatarUrl})}),(0,U.jsx)("td",{children:e.login}),(0,U.jsx)("td",{children:e.email}),(0,U.jsx)("td",{children:e.name}),this.renderPermissions(e),s&&this.renderLabels(e.labels),(0,U.jsx)("td",{className:"text-right",children:(0,U.jsx)(F.m,{"aria-label":`Remove team member ${e.name}`,size:"sm",disabled:!t,onConfirm:()=>this.onRemoveMember(e)})})]},e.userId)}}const X=J(K);var Y,ee,se,te,ae,ne,re,ie,oe=t(7686);function de(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}const le={addTeamMember:M.Lt,setSearchMemberQuery:oe.UD},me=(0,h.connect)((function(e){return{searchMemberQuery:(0,N.xc)(e.team),editorsCanAdmin:x.vc.editorsCanAdmin,signedInUser:j.Vt.user}}),le);class ce extends c.PureComponent{constructor(e){super(e),de(this,"onSearchQueryChange",(e=>{this.props.setSearchMemberQuery(e)})),de(this,"onToggleAdding",(()=>{this.setState({isAdding:!this.state.isAdding})})),de(this,"onUserSelected",(e=>{this.setState({newTeamMember:e})})),de(this,"onAddUserToTeam",(async()=>{this.props.addTeamMember(this.state.newTeamMember.id),this.setState({newTeamMember:null})})),this.state={isAdding:!1,newTeamMember:null}}renderLabels(e){return e?(0,U.jsx)("td",{children:e.map((e=>(0,U.jsx)(Z.e,{label:e,removeIcon:!1,count:0},e)))}):Y||(Y=(0,U.jsx)("td",{}))}render(){const{isAdding:e}=this.state,{searchMemberQuery:s,members:t,syncEnabled:a,editorsCanAdmin:n,signedInUser:r}=this.props,i=(0,N.vt)({members:t,editorsCanAdmin:n,signedInUser:r});return(0,U.jsxs)("div",{children:[(0,U.jsxs)("div",{className:"page-action-bar",children:[(0,U.jsx)("div",{className:"gf-form gf-form--grow",children:(0,U.jsx)(W.H,{placeholder:"Search members",value:s,onChange:this.onSearchQueryChange})}),(0,U.jsx)(y.zx,{className:"pull-right",onClick:this.onToggleAdding,disabled:e||!i,children:"Add member"})]}),(0,U.jsx)(P.s,{in:e,children:(0,U.jsxs)("div",{className:"cta-form",children:[(0,U.jsx)(S.P,{"aria-label":"Close 'Add team member' dialogue",onClick:this.onToggleAdding}),ee||(ee=(0,U.jsx)(O._,{htmlFor:"user-picker",children:"Add team member"})),(0,U.jsxs)("div",{className:"gf-form-inline",children:[(0,U.jsx)(_.f,{inputId:"user-picker",onSelected:this.onUserSelected,className:"min-width-30"}),this.state.newTeamMember&&(0,U.jsx)(y.zx,{type:"submit",onClick:this.onAddUserToTeam,children:"Add to team"})]})]})}),(0,U.jsx)("div",{className:"admin-list-table",children:(0,U.jsxs)("table",{className:"filter-table filter-table--hover form-inline",children:[(0,U.jsx)("thead",{children:(0,U.jsxs)("tr",{children:[se||(se=(0,U.jsx)("th",{})),te||(te=(0,U.jsx)("th",{children:"Login"})),ae||(ae=(0,U.jsx)("th",{children:"Email"})),ne||(ne=(0,U.jsx)("th",{children:"Name"})),(0,U.jsx)(Q,{featureToggle:n,children:re||(re=(0,U.jsx)("th",{children:"Permission"}))}),a&&(ie||(ie=(0,U.jsx)("th",{}))),(0,U.jsx)("th",{style:{width:"1%"}})]})}),(0,U.jsx)("tbody",{children:t&&t.map((e=>(0,U.jsx)(X,{member:e,syncEnabled:a,editorsCanAdmin:n,signedInUserIsTeamAdmin:i},e.userId)))})]})})]})}}const he=me(ce);var ue=t(58117);const pe=e=>{const s=j.Vt.hasPermissionInMetadata(v.bW.ActionTeamsPermissionsWrite,e.team);return(0,U.jsx)(ue.P,{title:"",addPermissionTitle:"Add member",buttonLabel:"Add member",emptyLabel:"There are no members in this team or you do not have the permissions to list the current members.",resource:"teams",resourceId:e.team.id,canSetPermissions:s})};var ge=t(54761),be=t(3218),xe=t(71980),fe=t(65678),je=t(75809),ve=t(97928),ye=t(55801),Te=t(62232);const Ae={updateTeam:M.fs},Ce=(0,h.connect)(null,Ae)((e=>{let{team:s,updateTeam:t}=e;const a=j.Vt.hasPermissionInMetadata(v.bW.ActionTeamsWrite,s),n=j.Vt.user.orgId,[{roleOptions:r}]=(0,ye.C)(n),[i,o]=(0,c.useState)([]),d=j.Vt.hasPermission(v.bW.ActionUserRolesAdd)&&j.Vt.hasPermission(v.bW.ActionUserRolesRemove);return(0,U.jsxs)(ge.wc,{spacing:"lg",children:[(0,U.jsx)(be.l,{defaultValues:Object.assign({},s),onSubmit:async e=>{j.Vt.licensedAccessControlEnabled()&&d&&await(0,ve.u7)(i,s.id),t(e.name,e.email)},disabled:!a,children:e=>{let{register:t,errors:n}=e;return(0,U.jsxs)(xe.C,{label:"Team details",children:[(0,U.jsx)(fe.g,{label:"Name",disabled:!a,required:!0,invalid:!!n.name,error:"Name is required",children:(0,U.jsx)(I.I,Object.assign({},t("name",{required:!0}),{id:"name-input"}))}),j.Vt.licensedAccessControlEnabled()&&(0,U.jsx)(fe.g,{label:"Role",children:(0,U.jsx)(je.f,{teamId:s.id,roleOptions:r,disabled:!1,apply:!0,onApplyRoles:o,pendingRoles:i,maxWidth:"100%"})}),(0,U.jsx)(fe.g,{label:"Email",description:"This is optional and is primarily used to set the team profile avatar (via gravatar service).",disabled:!a,children:(0,U.jsx)(I.I,Object.assign({},t("email"),{placeholder:"team@email.com",type:"email",id:"email-input"}))}),(0,U.jsx)(y.zx,{type:"submit",disabled:!a,children:"Update"})]})}}),(0,U.jsx)(Te.v,{resourceUri:`teams/${s.id}`,disabled:!a})]})}));var we,Ie,Pe,Se=t(74392);function Le(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}!function(e){e.Members="members",e.Settings="settings",e.GroupSync="groupsync"}(Pe||(Pe={}));const ke={loadTeam:M.QX,loadTeamMembers:M.ei},Me=(0,h.connect)((function(e,s){var t;const a=parseInt(s.match.params.id,10),n=(0,N.VP)(e.team,a);let r="members";j.Vt.accessControlEnabled()&&(n&&j.Vt.hasPermissionInMetadata(v.bW.ActionTeamsPermissionsRead,n)||(r="settings"));const i=null!==(t=s.match.params.page)&&void 0!==t?t:r,o=(0,Se.o)(i);return{pageNav:(0,f.ht)(e.navIndex,`team-${i}-${a}`,o).main,teamId:a,pageName:i,team:n,members:(0,N.YY)(e.team),editorsCanAdmin:x.ZP.editorsCanAdmin,signedInUser:j.Vt.user}}),ke);class Ne extends c.PureComponent{constructor(e){super(e),Le(this,"textsAreEqual",((e,s)=>!e&&!s||!(!e||!s)&&e.toLocaleLowerCase()===s.toLocaleLowerCase())),Le(this,"hideTabsFromNonTeamAdmin",((e,s)=>(j.Vt.accessControlEnabled()||!s&&e&&e.children&&e.children.filter((e=>!this.textsAreEqual(e.text,Pe.Members))).map((e=>{e.hideFromTabs=!0})),e))),this.state={isLoading:!1,isSyncEnabled:(0,u.v)("teamsync")}}async componentDidMount(){await this.fetchTeam()}async fetchTeam(){const{loadTeam:e,teamId:s}=this.props;this.setState({isLoading:!0});const t=await e(s);return j.Vt.accessControlEnabled()||await this.props.loadTeamMembers(),this.setState({isLoading:!1}),t}getCurrentPage(){const e=["members","settings","groupsync"],s=this.props.pageName;return(0,m.includes)(e,s)?s:e[0]}renderPage(e){const{isSyncEnabled:s}=this.state,{members:t,team:a}=this.props,n=this.getCurrentPage(),r=j.Vt.hasAccessInMetadata(v.bW.ActionTeamsRead,a,e),i=j.Vt.hasAccessInMetadata(v.bW.ActionTeamsPermissionsRead,a,e),o=j.Vt.hasAccessInMetadata(v.bW.ActionTeamsPermissionsWrite,a,e);switch(n){case Pe.Members:return j.Vt.accessControlEnabled()?(0,U.jsx)(pe,{team:a}):(0,U.jsx)(he,{syncEnabled:s,members:t});case Pe.Settings:return r&&(0,U.jsx)(Ce,{team:a});case Pe.GroupSync:if(s){if(i)return(0,U.jsx)(z,{isReadOnly:!o})}else if(x.ZP.featureToggles.featureHighlights)return(0,U.jsxs)(U.Fragment,{children:[we||(we=(0,U.jsx)(b.Xz,{featureName:"team sync",featureId:"team-sync"})),Ie||(Ie=(0,U.jsx)($,{}))]})}return null}render(){const{team:e,pageNav:s,members:t,editorsCanAdmin:a,signedInUser:n}=this.props,r=(0,N.vt)({members:t,editorsCanAdmin:a,signedInUser:n});return(0,U.jsx)(g.T,{navId:"teams",pageNav:this.hideTabsFromNonTeamAdmin(s,r),children:(0,U.jsx)(g.T.Contents,{isLoading:this.state.isLoading,children:e&&0!==Object.keys(e).length&&this.renderPage(r)})})}}const Ue=Me((0,p.HE)(Ne))},2958:(e,s,t)=>{t.d(s,{A_:()=>x,Lt:()=>u,P5:()=>f,QX:()=>c,ei:()=>h,fC:()=>j,fs:()=>g,jI:()=>m,j_:()=>b,zT:()=>p,zZ:()=>v});var a=t(93570),n=t(93686),r=t(68374),i=t(83997),o=t(64850),d=t(74392),l=t(7686);function m(){return async e=>{if(!r.Vt.hasPermission(o.bW.ActionTeamsRead))return void e((0,l.PL)([]));const s=await(0,a.i)().get("/api/teams/search",(0,i.y)({perpage:1e3,page:1}));e((0,l.PL)(s.teams))}}function c(e){return async s=>{const t=await(0,a.i)().get(`/api/teams/${e}`,(0,i.y)());s((0,l.y$)(t)),s((0,n.RL)((0,d.B)(t)))}}function h(){return async(e,s)=>{const t=s().team.team,n=await(0,a.i)().get(`/api/teams/${t.id}/members`);e((0,l.n2)(n))}}function u(e){return async(s,t)=>{const n=t().team.team;await(0,a.i)().post(`/api/teams/${n.id}/members`,{userId:e}),s(h())}}function p(e){return async(s,t)=>{const n=t().team.team;await(0,a.i)().delete(`/api/teams/${n.id}/members/${e}`),s(h())}}function g(e,s){return async(t,n)=>{const r=n().team.team;await(0,a.i)().put(`/api/teams/${r.id}`,{name:e,email:s}),t(c(r.id))}}function b(){return async(e,s)=>{const t=s().team.team,n=await(0,a.i)().get(`/api/teams/${t.id}/groups`);e((0,l.iI)(n))}}function x(e){return async(s,t)=>{const n=t().team.team;await(0,a.i)().post(`/api/teams/${n.id}/groups`,{groupId:e}),s(b())}}function f(e){return async(s,t)=>{const n=t().team.team;await(0,a.i)().delete(`/api/teams/${n.id}/groups/${encodeURIComponent(e)}`),s(b())}}function j(e){return async s=>{await(0,a.i)().delete(`/api/teams/${e}`),await r.Vt.fetchUserPermissions(),s(m())}}function v(e){return async s=>{await(0,a.i)().put(`/api/teams/${e.teamId}/members/${e.userId}`,{permission:e.permission}),s(h())}}},74392:(e,s,t)=>{t.d(s,{B:()=>m,o:()=>c});var a=t(72677),n=t(53277),r=t(46782),i=t(59196),o=t(54168),d=t(64850);const l={avatarUrl:"public/img/user_profile.png",id:1,name:"Loading",email:"loading",memberCount:0,permission:d.hw.Member};function m(e){const s={img:e.avatarUrl,id:"team-"+e.id,subTitle:"Manage members and settings",url:"",text:e.name,breadcrumbs:[{title:"Teams",url:"org/teams"}],children:[{active:!1,icon:"sliders-v-alt",id:`team-settings-${e.id}`,text:"Settings",url:`org/teams/edit/${e.id}/settings`}]};(e===l||i.Vt.hasPermissionInMetadata(d.bW.ActionTeamsPermissionsRead,e))&&s.children.unshift({active:!1,icon:"users-alt",id:`team-members-${e.id}`,text:"Members",url:`org/teams/edit/${e.id}/members`});const t={active:!1,icon:"sync",id:`team-groupsync-${e.id}`,text:"External group sync",url:`org/teams/edit/${e.id}/groupsync`},m=e===l;return(0,o.d5)()&&(t.tabSuffix=()=>(0,n.Z)({experimentId:m?"":"feature-highlights-team-sync-badge",eventVariant:"trial"})),(0,a.v)("teamsync")?(m||i.Vt.hasPermissionInMetadata(d.bW.ActionTeamsPermissionsRead,e))&&s.children.push(t):r.ZP.featureToggles.featureHighlights&&s.children.push(Object.assign({},t,{tabSuffix:()=>(0,n.Z)({experimentId:m?"":"feature-highlights-team-sync-badge"})})),s}function c(e){const s=m(l);let t;for(const a of s.children)if(a.id.indexOf(e)>0){a.active=!0,t=a;break}return{main:s,node:t}}},68021:(e,s,t)=>{t.d(s,{JB:()=>i,LK:()=>m,VP:()=>l,YY:()=>c,_u:()=>d,kC:()=>u,uP:()=>n,v7:()=>o,vt:()=>h,xc:()=>r});var a=t(64850);const n=e=>e.searchQuery,r=e=>e.searchMemberQuery,i=e=>e.groups,o=e=>e.teams.length,d=e=>e.searchPage,l=(e,s)=>e.team.id===parseInt(s,10)?e.team:null,m=e=>{const s=RegExp(e.searchQuery,"i");return e.teams.filter((e=>s.test(e.name)))},c=e=>{const s=RegExp(e.searchMemberQuery,"i");return e.members.filter((e=>s.test(e.login)||s.test(e.email)||s.test(e.name)))},h=e=>{const{members:s,signedInUser:t,editorsCanAdmin:n}=e,r=s.find((e=>e.userId===t.id)),i=r?r.permission:a.hw.Member;return u({permission:i,signedInUser:t,editorsCanAdmin:n})},u=e=>{const{permission:s,signedInUser:t,editorsCanAdmin:n}=e,r=t.isGrafanaAdmin||t.orgRole===a.B5.Admin,i=s===a.hw.Admin;return r||i||!n}}}]);
//# sourceMappingURL=TeamPages.4c2472f509b961e34635.js.map