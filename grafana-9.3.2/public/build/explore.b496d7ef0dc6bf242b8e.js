"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9782],{2179:(e,t,s)=>{s.d(t,{f:()=>i});const i=e=>Boolean(e)},66263:(e,t,s)=>{s.d(t,{K:()=>g});var i=s(7197),o=s(3363),n=s(8910),r=s(39321);const a=["sourceUID","targetUID"],l=["sourceUID"],c=["sourceUID","uid"];function d(e,t){if(null==e)return{};var s,i,o={},n=Object.keys(e);for(i=0;i<n.length;i++)s=n[i],t.indexOf(s)>=0||(o[s]=e[s]);return o}const h=e=>{let{sourceUID:t,targetUID:s}=e,i=d(e,a);return Object.assign({},i,{source:(0,n.F)().getInstanceSettings(t),target:(0,n.F)().getInstanceSettings(s)})},u=e=>e.map(h);function p(e){return e.data}const g=()=>{const{backend:e}=(0,r.p)(),[t,s]=(0,i.Z)((()=>(0,o.n)(e.fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1})).then(p).then(u)),[e]),[n,a]=(0,i.Z)((t=>{let{sourceUID:s}=t,i=d(t,l);return e.post(`/api/datasources/uid/${s}/correlations`,i).then(h)}),[e]),[g,f]=(0,i.Z)((t=>{let{sourceUID:s,uid:i}=t;return e.delete(`/api/datasources/uid/${s}/correlations/${i}`)}),[e]),[m,y]=(0,i.Z)((t=>{let{sourceUID:s,uid:i}=t,o=d(t,c);return e.patch(`/api/datasources/uid/${s}/correlations/${i}`,o).then(h)}),[e]);return{create:Object.assign({execute:a},n),update:Object.assign({execute:y},m),get:Object.assign({execute:s},t),remove:Object.assign({execute:f},g)}}},58408:(e,t,s)=>{s.r(t),s.d(t,{default:()=>mo});var i=s(52423),o=s(68404),n=s(80795),r=s(27783),a=s(72767),l=s(39321),c=s(47900),d=s(40901),h=s(2179),u=s(64850),p=s(75334),g=s(65632),f=s(66263),m=s(55560),y=s(25822),v=s(88006),x=s(37744);const b=e=>{let{exploreIdLeft:t,exploreIdRight:s}=e;const[i,n]=(0,o.useState)([]),{query:r}=(0,m.useKBar)(),a=(0,u.I0)(),l=(0,u.v9)(x.p);return(0,o.useEffect)((()=>{const e={name:"Explore",priority:m.Priority.HIGH+1},i=[];l?(i.push({id:"explore/run-query-left",name:"Run query (left)",keywords:"query left",perform:()=>{a((0,v.aA)(t))},section:e}),s&&(i.push({id:"explore/run-query-right",name:"Run query (right)",keywords:"query right",perform:()=>{a((0,v.aA)(s))},section:e}),i.push({id:"explore/split-view-close-left",name:"Close split view left",keywords:"split",perform:()=>{a((0,y.YV)(t))},section:e}),i.push({id:"explore/split-view-close-right",name:"Close split view right",keywords:"split",perform:()=>{a((0,y.YV)(s))},section:e}))):(i.push({id:"explore/run-query",name:"Run query",keywords:"query",perform:()=>{a((0,v.aA)(t))},section:e}),i.push({id:"explore/split-view-open",name:"Open split view",keywords:"split",perform:()=>{a((0,y.bW)())},section:e})),n(i)}),[t,s,l,r,a]),(0,m.useRegisterActions)(r?i:[],[i,r]),null};var w=s(58635),S=s(36635),R=s(25317),j=s(25004),C=s(16755),z=s(46782),T=s(78130),I=s(11848),k=s(31135),F=s(42833),E=s(67040),O=s(82897),L=s(89050),D=s(28173),N=s(8910),H=s(31181),$=s(65737),P=s(38595),M=s(22222),B=s(91288),A=s(49256),q=s(2247),_=s(83821),W=s(10098),Q=s(8105),Z=function(e){return(e+1)%1e6};function V(e,t){return"function"==typeof e?e.length?e(t):e():e}function U(e){var t=(0,o.useRef)(V(e)),s=(0,o.useReducer)(Z,0)[1];return(0,o.useMemo)((function(){return[function(){return t.current},function(e){t.current=V(e,t.current),s()}]}),[])}var G=s(78453),K=s(663),Y=s(88246),J=s(71855),X=s(32934),ee=s(60053),te=s(76308),se=s(27864),ie=s(99500),oe=s(59821),ne=s(14496),re=s(64421);var ae=s(45916);function le(e){let{data:t,height:s,width:n,timeZone:a,absoluteRange:l,onChangeTime:c,loadingState:d,annotations:h,onHiddenSeriesChanged:u,splitOpenFn:p,graphStyle:g,tooltipDisplayMode:f=se.f3.Single,anchorToZero:m,eventBus:y}=e;const v=(0,C.l4)(),x=(0,C.wW)(ce),[b,w]=(0,o.useState)(!1),[S,{inc:R}]=function(e,t,s){void 0===e&&(e=0),void 0===t&&(t=null),void 0===s&&(s=null);var i=V(e);"number"!=typeof i&&console.error("initialValue has to be a number, got "+typeof e),"number"==typeof s?i=Math.max(i,s):null!==s&&console.error("min has to be a number, got "+typeof s),"number"==typeof t?i=Math.min(i,t):null!==t&&console.error("max has to be a number, got "+typeof t);var n=U(i),r=n[0],a=n[1];return[r(),(0,o.useMemo)((function(){var e=function(e){var i=r(),o=V(e,i);i!==o&&("number"==typeof s&&(o=Math.max(o,s)),"number"==typeof t&&(o=Math.min(o,t)),i!==o&&a(o))};return{get:r,set:e,inc:function(t){void 0===t&&(t=1);var s=V(t,r());"number"!=typeof s&&console.error("delta has to be a number or function returning a number, got "+typeof s),e((function(e){return e+s}))},dec:function(t){void 0===t&&(t=1);var s=V(t,r());"number"!=typeof s&&console.error("delta has to be a number or function returning a number, got "+typeof s),e((function(e){return e-s}))},reset:function(t){void 0===t&&(t=i);var s=V(t,r());"number"!=typeof s&&console.error("value has to be a number or function returning a number, got "+typeof s),i=s,e(s)}}}),[i,s,t])]}(1),j=(0,o.useMemo)((()=>(0,G.j)((0,oe.F)(oe.r),"Explore")),[]),[z,T]=(0,o.useState)({defaults:{min:m?0:void 0,color:{mode:K.S.PaletteClassic},custom:{drawStyle:se.l8.Line,fillOpacity:0,pointSize:5}},overrides:[]}),I={from:(0,Y.CQ)(l.from),to:(0,Y.CQ)(l.to),raw:{from:(0,Y.CQ)(l.from),to:(0,Y.CQ)(l.to)}},k=(0,o.useMemo)((()=>function(e,t){return(0,re.ZP)(e,(e=>{void 0===e.defaults.custom&&(e.defaults.custom={});const{custom:s}=e.defaults;switch(void 0===s.stacking&&(s.stacking={group:"A"}),t){case"lines":s.drawStyle=se.l8.Line,s.stacking.mode=se.o0.None,s.fillOpacity=0;break;case"bars":s.drawStyle=se.l8.Bars,s.stacking.mode=se.o0.None,s.fillOpacity=100;break;case"points":s.drawStyle=se.l8.Points,s.stacking.mode=se.o0.None,s.fillOpacity=0;break;case"stacked_lines":s.drawStyle=se.l8.Line,s.stacking.mode=se.o0.Normal,s.fillOpacity=100;break;case"stacked_bars":s.drawStyle=se.l8.Bars,s.stacking.mode=se.o0.Normal,s.fillOpacity=100;break;default:throw new Error(`Invalid graph-style: ${t}`)}}))}(z,g)),[z,g]),F=(0,o.useMemo)((()=>(0,J.SM)({fieldConfig:k,data:t,timeZone:a,replaceVariables:e=>e,theme:v,fieldConfigRegistry:j})),[j,t,a,v,k]);(0,o.useMemo)(R,[F.length,k,R]),(0,o.useEffect)((()=>{if(u){const e=[];F.forEach((t=>{t.fields.map((e=>{var t,s,i;return null===(t=e.config)||void 0===t||null===(s=t.custom)||void 0===s||null===(i=s.hideFrom)||void 0===i?void 0:i.viz})).every(O.identity)&&e.push((0,X.n)(t))})),u(e)}}),[F,u]);const E=b?F:F.slice(0,20),L={eventBus:y,sync:()=>ee.m.Crosshair,onSplitOpen:p,onToggleSeriesVisibility(e,s){T((0,ne.N)(e,s,z,t))}},D=(0,o.useMemo)((()=>({tooltip:{mode:f,sort:se.As.None},legend:{displayMode:se.jK.List,showLegend:!0,placement:"bottom",calcs:[]}})),[f]);return(0,ae.jsxs)(r._w,{value:L,children:[F.length>20&&!b&&(0,ae.jsxs)("div",{className:(0,i.cx)([x.timeSeriesDisclaimer]),children:[(0,ae.jsx)(ie.J,{className:x.disclaimerIcon,name:"exclamation-triangle"}),"Showing only 20 time series. ",(0,ae.jsx)("span",{className:(0,i.cx)([x.showAllTimeSeries]),onClick:()=>{w(!0)},children:`Show all ${F.length}`})]}),(0,ae.jsx)(te.$,{data:{series:E,timeRange:I,state:d,annotations:h,structureRev:S},pluginId:"timeseries",title:"",width:n,height:s,onChangeTimeRange:c,timeZone:a,options:D})]})}const ce=e=>({timeSeriesDisclaimer:i.css`
    label: time-series-disclaimer;
    width: 300px;
    margin: ${e.spacing(1)} auto;
    padding: 10px 0;
    border-radius: ${e.spacing(2)};
    text-align: center;
    background-color: ${e.colors.background.primary};
  `,disclaimerIcon:i.css`
    label: disclaimer-icon;
    color: ${e.colors.warning.main};
    margin-right: ${e.spacing(.5)};
  `,showAllTimeSeries:i.css`
    label: show-all-time-series;
    cursor: pointer;
    color: ${e.colors.text.link};
  `});var de=s(37625);const he=u.f0.map((e=>({value:e,label:e[0].toUpperCase()+e.slice(1).replace(/_/," ")}))),ue=(0,i.css)({display:"flex",justifyContent:"space-between"});function pe(e){const{graphStyle:t,onChangeGraphStyle:s}=e;return(0,ae.jsxs)("div",{className:ue,children:["Graph",(0,ae.jsx)(de.S,{size:"sm",options:he,value:t,onChange:s})]})}var ge,fe=s(54316),me=s(54671),ye=s(97394),ve=(ge=function(e,t){return ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])},ge(e,t)},function(e,t){function s(){this.constructor=e}ge(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}),xe=function(){return xe=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var o in t=arguments[s])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xe.apply(this,arguments)},be={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},we={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},Se={width:"20px",height:"20px",position:"absolute"},Re={top:xe(xe({},be),{top:"-5px"}),right:xe(xe({},we),{left:void 0,right:"-5px"}),bottom:xe(xe({},be),{top:void 0,bottom:"-5px"}),left:xe(xe({},we),{left:"-5px"}),topRight:xe(xe({},Se),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:xe(xe({},Se),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:xe(xe({},Se),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:xe(xe({},Se),{left:"-10px",top:"-10px",cursor:"nw-resize"})},je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return ve(t,e),t.prototype.render=function(){return o.createElement("div",{className:this.props.className||"",style:xe(xe({position:"absolute",userSelect:"none"},Re[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(o.PureComponent),Ce=function(){var e=function(t,s){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])},e(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),ze=function(){return ze=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var o in t=arguments[s])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ze.apply(this,arguments)},Te={width:"auto",height:"auto"},Ie=function(e,t,s){return Math.max(Math.min(e,s),t)},ke=function(e,t){return Math.round(e/t)*t},Fe=function(e,t){return new RegExp(e,"i").test(t)},Ee=function(e){return Boolean(e.touches&&e.touches.length)},Oe=function(e,t,s){void 0===s&&(s=0);var i=t.reduce((function(s,i,o){return Math.abs(i-e)<Math.abs(t[s]-e)?o:s}),0),o=Math.abs(t[i]-e);return 0===s||o<s?t[i]:e},Le=function(e){return"auto"===(e=e.toString())||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},De=function(e,t,s,i){if(e&&"string"==typeof e){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%"))return t*(Number(e.replace("%",""))/100);if(e.endsWith("vw"))return s*(Number(e.replace("vw",""))/100);if(e.endsWith("vh"))return i*(Number(e.replace("vh",""))/100)}return e},Ne=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],He="__resizable_base__",$e=function(e){function t(t){var s=e.call(this,t)||this;return s.ratio=1,s.resizable=null,s.parentLeft=0,s.parentTop=0,s.resizableLeft=0,s.resizableRight=0,s.resizableTop=0,s.resizableBottom=0,s.targetLeft=0,s.targetTop=0,s.appendBase=function(){if(!s.resizable||!s.window)return null;var e=s.parentNode;if(!e)return null;var t=s.window.document.createElement("div");return t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0 0 100%",t.classList?t.classList.add(He):t.className+=He,e.appendChild(t),t},s.removeBase=function(e){var t=s.parentNode;t&&t.removeChild(e)},s.ref=function(e){e&&(s.resizable=e)},s.state={isResizing:!1,width:void 0===(s.propsSize&&s.propsSize.width)?"auto":s.propsSize&&s.propsSize.width,height:void 0===(s.propsSize&&s.propsSize.height)?"auto":s.propsSize&&s.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},s.onResizeStart=s.onResizeStart.bind(s),s.onMouseMove=s.onMouseMove.bind(s),s.onMouseUp=s.onMouseUp.bind(s),s}return Ce(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||Te},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var s=this.resizable.offsetWidth,i=this.resizable.offsetHeight,o=this.resizable.style.position;"relative"!==o&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:s,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:i,this.resizable.style.position=o}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,s=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&e.propsSize[t].toString().endsWith("%")){if(e.state[t].toString().endsWith("%"))return e.state[t].toString();var s=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/s[t]*100+"%"}return Le(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?Le(t.width):s("width"),height:t&&void 0!==t.height&&!this.state.isResizing?Le(t.height):s("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var t=!1,s=this.parentNode.style.flexWrap;"wrap"!==s&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%",e.style.minHeight="100%";var i={width:e.offsetWidth,height:e.offsetHeight};return t&&(this.parentNode.style.flexWrap=s),this.removeBase(e),i},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(e,t){var s=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==s&&"auto"!==s?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){var s,i,o=this.props.boundsByDirection,n=this.state.direction,r=o&&Fe("left",n),a=o&&Fe("top",n);if("parent"===this.props.bounds){var l=this.parentNode;l&&(s=r?this.resizableRight-this.parentLeft:l.offsetWidth+(this.parentLeft-this.resizableLeft),i=a?this.resizableBottom-this.parentTop:l.offsetHeight+(this.parentTop-this.resizableTop))}else"window"===this.props.bounds?this.window&&(s=r?this.resizableRight:this.window.innerWidth-this.resizableLeft,i=a?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(s=r?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),i=a?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return s&&Number.isFinite(s)&&(e=e&&e<s?e:s),i&&Number.isFinite(i)&&(t=t&&t<i?t:i),{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var s=this.props.scale||1,i=this.props.resizeRatio||1,o=this.state,n=o.direction,r=o.original,a=this.props,l=a.lockAspectRatio,c=a.lockAspectRatioExtraHeight,d=a.lockAspectRatioExtraWidth,h=r.width,u=r.height,p=c||0,g=d||0;return Fe("right",n)&&(h=r.width+(e-r.x)*i/s,l&&(u=(h-g)/this.ratio+p)),Fe("left",n)&&(h=r.width-(e-r.x)*i/s,l&&(u=(h-g)/this.ratio+p)),Fe("bottom",n)&&(u=r.height+(t-r.y)*i/s,l&&(h=(u-p)*this.ratio+g)),Fe("top",n)&&(u=r.height-(t-r.y)*i/s,l&&(h=(u-p)*this.ratio+g)),{newWidth:h,newHeight:u}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,s,i){var o=this.props,n=o.lockAspectRatio,r=o.lockAspectRatioExtraHeight,a=o.lockAspectRatioExtraWidth,l=void 0===i.width?10:i.width,c=void 0===s.width||s.width<0?e:s.width,d=void 0===i.height?10:i.height,h=void 0===s.height||s.height<0?t:s.height,u=r||0,p=a||0;if(n){var g=(d-u)*this.ratio+p,f=(h-u)*this.ratio+p,m=(l-p)/this.ratio+u,y=(c-p)/this.ratio+u,v=Math.max(l,g),x=Math.min(c,f),b=Math.max(d,m),w=Math.min(h,y);e=Ie(e,v,x),t=Ie(t,b,w)}else e=Ie(e,l,c),t=Ie(t,d,h);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var s=this.props.bounds.getBoundingClientRect();this.targetLeft=s.left,this.targetTop=s.top}if(this.resizable){var i=this.resizable.getBoundingClientRect(),o=i.left,n=i.top,r=i.right,a=i.bottom;this.resizableLeft=o,this.resizableRight=r,this.resizableTop=n,this.resizableBottom=a}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var s,i=0,o=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)?(i=e.nativeEvent.clientX,o=e.nativeEvent.clientY):e.nativeEvent&&Ee(e.nativeEvent)&&(i=e.nativeEvent.touches[0].clientX,o=e.nativeEvent.touches[0].clientY),this.props.onResizeStart)if(this.resizable)if(!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var n=this.window.getComputedStyle(this.resizable);if("auto"!==n.flexBasis){var r=this.parentNode;if(r){var a=this.window.getComputedStyle(r).flexDirection;this.flexDir=a.startsWith("row")?"row":"column",s=n.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var l={original:{x:i,y:o,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:ze(ze({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:s};this.setState(l)}},t.prototype.onMouseMove=function(e){var t=this;if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&Ee(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var s=this.props,i=s.maxWidth,o=s.maxHeight,n=s.minWidth,r=s.minHeight,a=Ee(e)?e.touches[0].clientX:e.clientX,l=Ee(e)?e.touches[0].clientY:e.clientY,c=this.state,d=c.direction,h=c.original,u=c.width,p=c.height,g=this.getParentSize(),f=function(e,t,s,i,o,n,r){return i=De(i,e.width,t,s),o=De(o,e.height,t,s),n=De(n,e.width,t,s),r=De(r,e.height,t,s),{maxWidth:void 0===i?void 0:Number(i),maxHeight:void 0===o?void 0:Number(o),minWidth:void 0===n?void 0:Number(n),minHeight:void 0===r?void 0:Number(r)}}(g,this.window.innerWidth,this.window.innerHeight,i,o,n,r);i=f.maxWidth,o=f.maxHeight,n=f.minWidth,r=f.minHeight;var m=this.calculateNewSizeFromDirection(a,l),y=m.newHeight,v=m.newWidth,x=this.calculateNewMaxFromBoundary(i,o);this.props.snap&&this.props.snap.x&&(v=Oe(v,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(y=Oe(y,this.props.snap.y,this.props.snapGap));var b=this.calculateNewSizeFromAspectRatio(v,y,{width:x.maxWidth,height:x.maxHeight},{width:n,height:r});if(v=b.newWidth,y=b.newHeight,this.props.grid){var w=ke(v,this.props.grid[0]),S=ke(y,this.props.grid[1]),R=this.props.snapGap||0;v=0===R||Math.abs(w-v)<=R?w:v,y=0===R||Math.abs(S-y)<=R?S:y}var j={width:v-h.width,height:y-h.height};if(u&&"string"==typeof u)if(u.endsWith("%"))v=v/g.width*100+"%";else if(u.endsWith("vw")){v=v/this.window.innerWidth*100+"vw"}else if(u.endsWith("vh")){v=v/this.window.innerHeight*100+"vh"}if(p&&"string"==typeof p)if(p.endsWith("%"))y=y/g.height*100+"%";else if(p.endsWith("vw")){y=y/this.window.innerWidth*100+"vw"}else if(p.endsWith("vh")){y=y/this.window.innerHeight*100+"vh"}var C={width:this.createSizeForCssProperty(v,"width"),height:this.createSizeForCssProperty(y,"height")};"row"===this.flexDir?C.flexBasis=C.width:"column"===this.flexDir&&(C.flexBasis=C.height),(0,ye.flushSync)((function(){t.setState(C)})),this.props.onResize&&this.props.onResize(e,d,this.resizable,j)}},t.prototype.onMouseUp=function(e){var t=this.state,s=t.isResizing,i=t.direction,o=t.original;if(s&&this.resizable){var n={width:this.size.width-o.width,height:this.size.height-o.height};this.props.onResizeStop&&this.props.onResizeStop(e,i,this.resizable,n),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:ze(ze({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,s=t.enable,i=t.handleStyles,n=t.handleClasses,r=t.handleWrapperStyle,a=t.handleWrapperClass,l=t.handleComponent;if(!s)return null;var c=Object.keys(s).map((function(t){return!1!==s[t]?o.createElement(je,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:i&&i[t],className:n&&n[t]},l&&l[t]?l[t]:null):null}));return o.createElement("div",{className:a,style:r},c)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,s){return-1!==Ne.indexOf(s)||(t[s]=e.props[s]),t}),{}),s=ze(ze(ze({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(s.flexBasis=this.state.flexBasis);var i=this.props.as||"div";return o.createElement(i,ze({ref:this.ref,style:s,className:this.props.className},t),this.state.isResizing&&o.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(o.PureComponent),Pe=s(50191);const Me=e=>i.keyframes`
  0% {
    transform: translateY(${e.components.horizontalDrawer.defaultHeight}px);
  }

  100% {
    transform: translateY(0px);
  }
`,Be=(0,Pe.B)((e=>({container:i.css`
      position: fixed !important;
      bottom: 0;
      background: ${e.colors.background.primary};
      border-top: 1px solid ${e.colors.border.weak};
      margin: ${e.spacing(0,-2,0,-2)};
      box-shadow: ${e.shadows.z3};
      z-index: ${e.zIndex.navbarFixed};
    `,drawerActive:i.css`
      opacity: 1;
      animation: 0.5s ease-out ${Me(e)};
    `,rzHandle:i.css`
      background: ${e.colors.secondary.main};
      transition: 0.3s background ease-in-out;
      position: relative;
      width: 200px !important;
      height: 7px !important;
      left: calc(50% - 100px) !important;
      top: -4px !important;
      cursor: grab;
      border-radius: 4px;
      &:hover {
        background: ${e.colors.secondary.shade};
      }
    `})));function Ae(e){const{width:t,children:s,onResize:o}=e,n=(0,C.l4)(),r=Be(n),a=`${t+31.5}px`;return(0,ae.jsx)($e,{className:(0,i.cx)(r.container,r.drawerActive),defaultSize:{width:a,height:`${n.components.horizontalDrawer.defaultHeight}px`},handleClasses:{top:r.rzHandle},enable:{top:!0,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},maxHeight:"100vh",maxWidth:a,minWidth:a,onResize:o,children:s})}var qe=s(76487),_e=s(20645),We=s(63886),Qe=s(61281),Ze=s(37796);const Ve={runQueries:v.aA},Ue=(0,S.connect)((function(e,t){let{exploreId:s}=t;const i=e.explore[s],{loading:o,queryResponse:n}=i;return{loading:o,queryResponse:n}}),Ve)((function(e){var t;const{loading:s,width:i,onClose:n,queryResponse:r,timeZone:a}=e,l=(null==r?void 0:r.series)||[],c=null==r?void 0:r.error;(0,o.useEffect)((()=>{(0,H.ff)("grafana_explore_query_inspector_opened")}),[]);const d={label:"Stats",value:"stats",icon:"chart-line",content:(0,ae.jsx)(Qe.f,{data:r,timeZone:null==r||null===(t=r.request)||void 0===t?void 0:t.timezone})},h={label:"JSON",value:"json",icon:"brackets-curly",content:(0,ae.jsx)(We.W,{data:r,onClose:n})},u={label:"Data",value:"data",icon:"database",content:(0,ae.jsx)(qe.E,{data:l,isLoading:s,options:{withTransforms:!1,withFieldConfig:!1},timeZone:a,app:fe.zj.Explore})},p=[d,{label:"Query",value:"query",icon:"info-circle",content:(0,ae.jsx)(Ze.D,{data:l,onRefreshQuery:()=>e.runQueries(e.exploreId)})},h,u];if(c){const e={label:"Error",value:"error",icon:"exclamation-triangle",content:(0,ae.jsx)(_e.l,{error:c})};p.push(e)}return(0,ae.jsx)(Ae,{width:i,children:(0,ae.jsx)(me.W,{tabs:p,onClose:n,closeIconTooltip:"Close query inspector"})})}));var Ge=s(94570),Ke=s(21162),Ye=s(1696),Je=s(94868),Xe=s(21084),et=s(80998),tt=s(14143),st=s(68374),it=s(40078),ot=s(29471),nt=s(53091),rt=s(69638),at=s(42914),lt=s(34759),ct=s(22342),dt=s(21888);function ht(e){const{onClick:t,isSynced:s}=e;return(0,ae.jsx)(dt.u,{content:()=>{const{isSynced:t}=e,s=t?"Unsync all views":"Sync all views to this time range";return(0,ae.jsx)(ae.Fragment,{children:s})},placement:"bottom",children:(0,ae.jsx)(Ye.h,{icon:"link",variant:s?"active":"default","aria-label":s?"Synced times":"Unsynced times",onClick:t})})}function ut(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class pt extends o.Component{constructor(){super(...arguments),ut(this,"onMoveTimePicker",(e=>{const{range:t,onChangeTime:s,timeZone:i}=this.props,{from:o,to:n}=(0,ct.e)(e,t);s({from:(0,Y.GY)(i,o),to:(0,Y.GY)(i,n)})})),ut(this,"onMoveForward",(()=>this.onMoveTimePicker(1))),ut(this,"onMoveBack",(()=>this.onMoveTimePicker(-1))),ut(this,"onChangeTimePicker",(e=>{const t=at.isMathString(e.raw.from)?e.raw.from:e.from,s=at.isMathString(e.raw.to)?e.raw.to:e.to;this.props.onChangeTime({from:t,to:s}),(0,H.ff)("grafana_explore_time_picker_time_range_changed",{timeRangeFrom:t,timeRangeTo:s})})),ut(this,"onZoom",(()=>{const{range:e,onChangeTime:t,timeZone:s}=this.props,{from:i,to:o}=(0,ct.h)(e,2);t({from:(0,Y.GY)(s,i),to:(0,Y.GY)(s,o)})}))}render(){const{range:e,timeZone:t,fiscalYearStartMonth:s,splitted:i,syncedTimes:o,onChangeTimeSync:n,hideText:r,onChangeTimeZone:a,onChangeFiscalYearStartMonth:l}=this.props,c=i?(0,ae.jsx)(ht,{onClick:n,isSynced:o}):void 0,d={value:e,timeZone:t,fiscalYearStartMonth:s,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,hideText:r};return(0,ae.jsx)(lt.a,Object.assign({},d,{timeSyncButton:c,isSynced:o,widthOverride:i?window.innerWidth/2:void 0,onChange:this.onChangeTimePicker,onChangeTimeZone:a,onChangeFiscalYearStartMonth:l}))}}var gt=s(22163),ft=s(98817);function mt(e){const{start:t,pause:s,resume:i,isLive:o,isPaused:n,stop:r,splitted:a}=e,l=o&&!n?"active":"default",c=o?n?i:s:t;return(0,ae.jsxs)(ft.h,{children:[(0,ae.jsx)(dt.u,{content:o&&!n?(0,ae.jsx)(ae.Fragment,{children:"Pause the live stream"}):(0,ae.jsx)(ae.Fragment,{children:"Start live stream your logs"}),placement:"bottom",children:(0,ae.jsx)(Ye.h,{iconOnly:a,variant:l,icon:!o||n?"play":"pause",onClick:c,children:o&&n?"Paused":"Live"})}),(0,ae.jsx)(gt.Z,{mountOnEnter:!0,unmountOnExit:!0,timeout:100,in:o,classNames:{enter:yt.stopButtonEnter,enterActive:yt.stopButtonEnterActive,exit:yt.stopButtonExit,exitActive:yt.stopButtonExitActive},children:(0,ae.jsx)(dt.u,{content:(0,ae.jsx)(ae.Fragment,{children:"Stop and exit the live stream"}),placement:"bottom",children:(0,ae.jsx)(Ye.h,{variant:l,onClick:r,icon:"square-shape"})})})]})}const yt={stopButtonEnter:i.css`
    label: stopButtonEnter;
    width: 0;
    opacity: 0;
    overflow: hidden;
  `,stopButtonEnterActive:i.css`
    label: stopButtonEnterActive;
    opacity: 1;
    width: 32px;
  `,stopButtonExit:i.css`
    label: stopButtonExit;
    width: 32px;
    opacity: 1;
    overflow: hidden;
  `,stopButtonExitActive:i.css`
    label: stopButtonExitActive;
    opacity: 0;
    width: 0;
  `};var vt=s(90860),xt=s(40232);function bt(e){const t=function(e){const t=(0,u.I0)(),s=(0,o.useCallback)((()=>{t((0,v.sQ)({exploreId:e,isPaused:!0}))}),[e,t]),i=(0,o.useCallback)((()=>{t((0,v.sQ)({exploreId:e,isPaused:!1}))}),[e,t]),n=(0,o.useCallback)((()=>{s(),t((0,xt.oz)(e,Ke.dP.offOption.value)),t((0,v.aA)(e))}),[e,t,s]),r=(0,o.useCallback)((()=>{t((0,xt.oz)(e,Ke.dP.liveOption.value))}),[e,t]);return{pause:s,resume:i,stop:n,start:r}}(e.exploreId);return e.children(t)}function wt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const St=(0,o.lazy)((()=>s.e(3270).then(s.bind(s,73270)).then((e=>{let{AddToDashboard:t}=e;return{default:t}}))));class Rt extends o.PureComponent{constructor(){var e;super(...arguments),e=this,wt(this,"onChangeDatasource",(async e=>{const{changeDatasource:t,exploreId:s}=this.props;t(s,e.uid,{importQueries:!0})})),wt(this,"onRunQuery",(function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{runQueries:s,cancelQueries:i,exploreId:o}=e.props;return t?i(o):s(o)})),wt(this,"onChangeRefreshInterval",(e=>{const{changeRefreshInterval:t,exploreId:s}=this.props;t(s,e)})),wt(this,"onChangeTimeSync",(()=>{const{syncTimes:e,exploreId:t}=this.props;e(t)})),wt(this,"onCopyShortLink",(async()=>{await(0,it.L)(window.location.href),(0,H.ff)("grafana_explore_shortened_link_clicked")})),wt(this,"onOpenSplitView",(()=>{const{split:e}=this.props;e(),(0,H.ff)("grafana_explore_split_view_opened",{origin:"menu"})})),wt(this,"onCloseSplitView",(()=>{const{closeSplit:e,exploreId:t}=this.props;e(t),(0,H.ff)("grafana_explore_split_view_closed")})),wt(this,"renderRefreshPicker",(e=>{const{loading:t,refreshInterval:s,isLive:i}=this.props;let o,n=t?"Cancel":"Run query",r="108px";return e&&(o=n,n=void 0,r="35px"),(0,ae.jsx)(Ke.dP,{onIntervalChanged:this.onChangeRefreshInterval,value:s,isLoading:t,text:n,tooltip:o,intervals:(0,nt.$t)().getValidIntervals(Ke.o5),isLive:i,onRefresh:()=>this.onRunQuery(t),noIntervalPicker:i,primary:!0,width:r},"refreshPicker")})),wt(this,"renderActions",(()=>{const{splitted:e,isLive:t,exploreId:s,range:i,timeZone:n,fiscalYearStartMonth:r,onChangeTime:a,syncedTimes:l,onChangeTimeZone:c,onChangeFiscalYearStartMonth:d,refreshInterval:h,loading:p,isPaused:g,hasLiveOption:f,containerWidth:m}=this.props,y=e||m<1210,v=st.Vt.hasAccess(u.bW.DashboardsCreate,st.Vt.isEditor)||st.Vt.hasAccess(u.bW.DashboardsWrite,st.Vt.isEditor);return[e?(0,ae.jsx)(Ye.h,{tooltip:"Close split pane",onClick:this.onCloseSplitView,icon:"times",children:"Close"},"split"):(0,ae.jsx)(Ye.h,{tooltip:"Split the pane",onClick:this.onOpenSplitView,icon:"columns",disabled:t,children:"Split"},"split"),v&&(0,ae.jsx)(o.Suspense,{fallback:null,children:(0,ae.jsx)(St,{exploreId:s})},"addToDashboard"),!t&&(0,ae.jsx)(pt,{exploreId:s,range:i,timeZone:n,fiscalYearStartMonth:r,onChangeTime:a,splitted:e,syncedTimes:l,onChangeTimeSync:this.onChangeTimeSync,hideText:y,onChangeTimeZone:c,onChangeFiscalYearStartMonth:d},"timeControls"),this.renderRefreshPicker(y),h&&(0,ae.jsx)(Je.F,{func:this.onRunQuery,interval:h,loading:p},"setInterval"),f&&(0,ae.jsx)(bt,{exploreId:s,children:s=>{const i=Object.assign({},s,{start:()=>{(0,H.ff)("grafana_explore_logs_live_tailing_clicked",{datasourceType:this.props.datasourceType}),s.start()}});return(0,ae.jsx)(mt,{splitted:e,isLive:t,isPaused:g,start:i.start,pause:i.pause,resume:i.resume,stop:i.stop})}},"liveControls")].filter(Boolean)}))}render(){const{datasourceMissing:e,exploreId:t,splitted:s,containerWidth:i,topOfViewRef:o}=this.props,n=(s?i<700:i<800)||!1,r=$.v.featureToggles.topnav,a=()=>(0,ae.jsx)(ot.u,{tooltip:"Copy shortened link",icon:"share-alt",onClick:this.onCopyShortLink,"aria-label":"Copy shortened link"},"share"),l=()=>!e&&(0,ae.jsx)(Ge.q,{mixed:!0===$.v.featureToggles.exploreMixedDatasource,onChange:this.onChangeDatasource,current:this.props.datasourceRef,hideTextValue:n,width:n?8:void 0},`${t}-ds-picker`),c=[a(),!s&&l(),(0,ae.jsx)("div",{style:{flex:1}},"spacer"),(0,ae.jsx)(Xe.R,{alignment:"right",children:this.renderActions()},"actions")].filter(Boolean),d=[t===p.K.left&&a(),l()].filter(Boolean),h=[t===p.K.left&&(0,ae.jsx)(tt.A,{actions:[a(),!s&&l(),(0,ae.jsx)("div",{style:{flex:1}},"spacer")].filter(Boolean)}),l()].filter(Boolean);return r&&!s?(0,ae.jsx)("div",{ref:o,children:(0,ae.jsx)(tt.A,{actions:c})}):(0,ae.jsx)("div",{ref:o,children:(0,ae.jsx)(et.X,{"aria-label":"Explore toolbar",title:t!==p.K.left||r?void 0:"Explore",pageIcon:t!==p.K.left||r?void 0:"compass",leftItems:r?h:d,children:this.renderActions()})})}}const jt={changeDatasource:vt.zU,changeRefreshInterval:xt.oz,cancelQueries:v.ci,runQueries:v.aA,closeSplit:y.YV,split:y.bW,syncTimes:xt.mG,onChangeTimeZone:rt.YT,onChangeFiscalYearStartMonth:rt.rf},Ct=(0,S.connect)(((e,t)=>{var s;let{exploreId:i}=t;const{syncedTimes:o}=e.explore,n=e.explore[i],{datasourceInstance:r,datasourceMissing:a,range:l,refreshInterval:c,loading:d,isLive:h,isPaused:u,containerWidth:p}=n,g=!(null==r||null===(s=r.meta)||void 0===s||!s.streaming);return{datasourceMissing:a,datasourceRef:null==r?void 0:r.getRef(),datasourceType:null==r?void 0:r.type,loading:d,range:l,timeZone:(0,E.Z)(e.user),fiscalYearStartMonth:(0,E.i)(e.user),splitted:(0,x.p)(e),refreshInterval:c,hasLiveOption:g,isLive:h,isPaused:u,syncedTimes:o,containerWidth:p}}),jt)(Rt);var zt=s(69748);const Tt=e=>{const t=(0,C.wW)((e=>It(e)));return(0,ae.jsx)("div",{className:t.container,children:(0,ae.jsx)(zt.Z,{data:e.dataFrames[0],app:fe.zj.Explore})})},It=e=>({container:i.css`
    background: ${e.colors.background.primary};
    display: flow-root;
    padding: 0 ${e.spacing(1)} ${e.spacing(1)} ${e.spacing(1)};
    border: 1px solid ${e.components.panel.borderColor};
    border-radius: ${e.shape.borderRadius(1)};
  `});var kt=s(93246),Ft=s(35008),Et=s.n(Ft),Ot=s(6432),Lt=s(8006),Dt=s(43147),Nt=s(39609),Ht=s(13677);const $t=e=>{let{timeInMs:t,className:s,humanize:i}=e;return(0,ae.jsx)("span",{className:s,children:Pt(t,i)})},Pt=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=e/1e3;if(!t)return`${s.toFixed(1)}s`;const i=(0,Y.Ks)(s,"seconds"),o=i.hours(),n=i.minutes(),r=i.seconds();return o?`${o}h ${n}m ${r}s`:n?`${n}m ${r}s`:`${r}s`},Mt=e=>{let{resetKey:t,humanize:s,className:i}=e;const[n,r]=(0,o.useState)(0);return(0,Ht.Z)((()=>r(n+150)),150),(0,o.useEffect)((()=>r(0)),[t]),(0,ae.jsx)($t,{timeInMs:n,className:i,humanize:s})};var Bt;function At(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class qt extends o.PureComponent{constructor(e){super(e),At(this,"liveEndDiv",null),At(this,"scrollContainerRef",o.createRef()),At(this,"onScroll",(e=>{const{isPaused:t,onPause:s}=this.props,{scrollTop:i,clientHeight:o,scrollHeight:n}=e.currentTarget;n-(i+o)>=5&&!t&&s()})),At(this,"rowsToRender",(()=>{const{isPaused:e}=this.props;let{logRowsToRender:t=[]}=this.state;return e||(t=t.slice(-100)),t})),this.state={logRowsToRender:e.logRows}}static getDerivedStateFromProps(e,t){return e.isPaused?null:{logRowsToRender:e.logRows}}render(){const{theme:e,timeZone:t,onPause:s,onResume:o,isPaused:n}=this.props,r=(e=>({logsRowsLive:i.css`
    label: logs-rows-live;
    font-family: ${e.typography.fontFamilyMonospace};
    font-size: ${e.typography.bodySmall.fontSize};
    display: flex;
    flex-flow: column nowrap;
    height: 60vh;
    overflow-y: scroll;
    :first-child {
      margin-top: auto !important;
    }
  `,logsRowFade:i.css`
    label: logs-row-fresh;
    color: ${e.colors.text};
    background-color: ${Et()(e.colors.info.transparent).setAlpha(.25).toString()};
    animation: fade 1s ease-out 1s 1 normal forwards;
    @keyframes fade {
      from {
        background-color: ${Et()(e.colors.info.transparent).setAlpha(.25).toString()};
      }
      to {
        background-color: transparent;
      }
    }
  `,logsRowsIndicator:i.css`
    font-size: ${e.typography.h6.fontSize};
    padding-top: ${e.spacing(1)};
    display: flex;
    align-items: center;
  `,button:i.css`
    margin-right: ${e.spacing(1)};
  `,fullWidth:i.css`
    width: 100%;
  `}))(e),{logsRow:a,logsRowLocalTime:l,logsRowMessage:c}=(0,Nt.h)(e);return(0,ae.jsxs)("div",{children:[(0,ae.jsx)("table",{className:r.fullWidth,children:(0,ae.jsxs)("tbody",{onScroll:n?void 0:this.onScroll,className:r.logsRowsLive,ref:this.scrollContainerRef,children:[this.rowsToRender().map((e=>(0,ae.jsxs)("tr",{className:(0,i.cx)(a,r.logsRowFade),children:[(0,ae.jsx)("td",{className:l,children:(0,Ot.dq)(e.timeEpochMs,{timeZone:t})}),(0,ae.jsx)("td",{className:c,children:e.hasAnsi?(0,ae.jsx)(Dt.Q,{value:e.raw}):e.entry})]},e.uid))),(0,ae.jsx)("tr",{ref:e=>{var t,s;(this.liveEndDiv=e,this.liveEndDiv&&null!==(t=this.scrollContainerRef.current)&&void 0!==t&&t.scrollTo&&!n)&&(null===(s=this.scrollContainerRef.current)||void 0===s||s.scrollTo(0,this.scrollContainerRef.current.scrollHeight))}})]})}),(0,ae.jsxs)("div",{className:r.logsRowsIndicator,children:[(0,ae.jsxs)(Lt.zx,{variant:"secondary",onClick:n?o:s,className:r.button,children:[(0,ae.jsx)(ie.J,{name:n?"play":"pause"})," ",n?"Resume":"Pause"]}),(0,ae.jsxs)(Lt.zx,{variant:"secondary",onClick:this.props.stopLive,className:r.button,children:[Bt||(Bt=(0,ae.jsx)(ie.J,{name:"square-shape",size:"lg",type:"mono"})),"  Exit live mode"]}),n||(0,ae.jsxs)("span",{children:["Last line received: ",(0,ae.jsx)(Mt,{resetKey:this.props.logRows,humanize:!0})," ago"]})]})]})}}const _t=(0,C.HE)(qt);var Wt=s(92721),Qt=s(85699),Zt=s(34117),Vt=s(46889),Ut=s(70800),Gt=s(57322),Kt=s(67543),Yt=s(62427),Jt=s(17052),Xt=s(77372);const es=e=>({metaContainer:i.css`
    flex: 1;
    color: ${e.colors.text.secondary};
    margin-bottom: ${e.spacing(2)};
    min-width: 30%;
    display: flex;
    flex-wrap: wrap;
  `,metaItem:i.css`
    margin-right: ${e.spacing(2)};
    margin-top: ${e.spacing(.5)};
    display: flex;
    align-items: baseline;

    .logs-meta-item__error {
      color: ${e.colors.error.text};
    }
  `,metaLabel:i.css`
    margin-right: calc(${e.spacing(2)} / 2);
    font-size: ${e.typography.bodySmall.fontSize};
    font-weight: ${e.typography.fontWeightMedium};
  `,metaValue:i.css`
    font-family: ${e.typography.fontFamilyMonospace};
    font-size: ${e.typography.bodySmall.fontSize};
  `}),ts=(0,o.memo)((function(e){const t=(0,C.wW)(es),{label:s,value:i}=e;return(0,ae.jsxs)("div",{"data-testid":"meta-info-text-item",className:t.metaItem,children:[s&&(0,ae.jsxs)("span",{className:t.metaLabel,children:[s,":"]}),(0,ae.jsx)("span",{className:t.metaValue,children:i})]})})),ss=(0,o.memo)((function(e){const t=(0,C.wW)(es),{metaItems:s}=e;return(0,ae.jsx)("div",{className:t.metaContainer,"data-testid":"meta-info-text",children:s.map(((e,t)=>(0,ae.jsx)(ts,{label:e.label,value:e.value},`${t}-${e.label}`)))})})),is=()=>({metaContainer:i.css`
    flex: 1;
    display: flex;
    flex-wrap: wrap;
  `}),os=o.memo((e=>{let{meta:t,dedupStrategy:s,dedupCount:i,showDetectedFields:o,clearDetectedFields:n,hasUnescapedContent:r,forceEscape:a,onEscapeNewlines:l,logRows:c}=e;const d=(0,C.wW)(is),h=[...t];return s!==kt.Y4.none&&h.push({label:"Dedup count",value:i,kind:kt.Ku.Number}),c.some((e=>e.entry.length>Xt.n))&&h.push({label:"Info",value:"Logs with more than 100,000 characters could not be parsed and highlighted",kind:kt.Ku.String}),(null==o?void 0:o.length)>0&&h.push({label:"Showing only detected fields",value:ns(o,kt.Ku.LabelsMap)},{label:"",value:(0,ae.jsx)(Lt.zx,{variant:"secondary",size:"sm",onClick:n,children:"Show original line"})}),r&&h.push({label:"Your logs might have incorrectly escaped content",value:(0,ae.jsx)(dt.u,{content:"Fix incorrectly escaped newline and tab sequences in log lines. Manually review the results to confirm that the replacements are correct.",placement:"right",children:(0,ae.jsx)(Lt.zx,{variant:"secondary",size:"sm",onClick:l,children:a?"Remove escaping":"Escape newlines"})})}),(0,ae.jsx)(ae.Fragment,{children:h&&(0,ae.jsxs)("div",{className:d.metaContainer,children:[(0,ae.jsx)(ss,{metaItems:h.map((e=>({label:e.label,value:"kind"in e?ns(e.value,e.kind):e.value})))}),(0,ae.jsx)(Ye.h,{onClick:()=>{(0,Yt.Fc)({meta:t,rows:c},"Explore")},variant:"default",icon:"download-alt",children:"Download logs"})]})})}));function ns(e,t){return t===kt.Ku.LabelsMap?(0,ae.jsx)(Jt.j,{labels:e}):t===kt.Ku.Error?(0,ae.jsx)("span",{className:"logs-meta-item__error",children:e}):e}os.displayName="LogsMetaRow";var rs,as=s(81691),ls=s(74333);function cs(e){let{pages:t,currentPageIndex:s,oldestLogsFirst:o,timeZone:n,loading:r,changeTime:a}=e;const l=e=>`${(0,Ot.dq)(e,{format:ls.U6.interval.second,timeZone:n})}`,c=(e,t)=>{if(s===t&&r)return rs||(rs=(0,ae.jsx)(as.$,{}));return`${l(o?e.logsRange.from:e.logsRange.to)} — ${l(o?e.logsRange.to:e.logsRange.from)}`},d=(0,C.l4)(),h=ds(d,r);return(0,ae.jsx)(M.$,{autoHide:!0,children:(0,ae.jsx)("div",{className:h.pagesWrapper,"data-testid":"logsNavigationPages",children:(0,ae.jsx)("div",{className:h.pagesContainer,children:t.map(((e,t)=>(0,ae.jsxs)("button",{type:"button","data-testid":`page${t+1}`,className:h.page,onClick:()=>{(0,H.ff)("grafana_explore_logs_pagination_clicked",{pageType:"page",pageNumber:t+1}),!r&&a({from:e.queryRange.from,to:e.queryRange.to})},children:[(0,ae.jsx)("div",{className:(0,i.cx)(h.line,{selectedBg:s===t})}),(0,ae.jsx)("div",{className:(0,i.cx)(h.time,{selectedText:s===t}),children:c(e,t)})]},e.queryRange.to)))})})})}const ds=(e,t)=>({pagesWrapper:i.css`
      height: 100%;
      padding-left: ${e.spacing(.5)};
      display: flex;
      flex-direction: column;
      overflow-y: scroll;
      &::after {
        content: '';
        display: block;
        background: repeating-linear-gradient(
          135deg,
          ${e.colors.background.primary},
          ${e.colors.background.primary} 5px,
          ${e.colors.background.secondary} 5px,
          ${e.colors.background.secondary} 15px
        );
        width: 3px;
        height: inherit;
        margin-bottom: 8px;
      }
    `,pagesContainer:i.css`
      display: flex;
      padding: 0;
      flex-direction: column;
    `,page:i.css`
      ${(0,Lt.gN)(e)}
      display: flex;
      margin: ${e.spacing(2)} 0;
      cursor: ${t?"auto":"pointer"};
      white-space: normal;
      .selectedBg {
        background: ${e.colors.primary.main};
      }
      .selectedText {
        color: ${e.colors.primary.main};
      }
    `,line:i.css`
      width: 3px;
      height: 100%;
      align-items: center;
      background: ${e.colors.text.secondary};
    `,time:i.css`
      width: 60px;
      min-height: 80px;
      font-size: ${e.v1.typography.size.sm};
      padding-left: ${e.spacing(.5)};
      display: flex;
      align-items: center;
    `});var hs,us,ps;function gs(e){let{absoluteRange:t,logsSortOrder:s,timeZone:i,loading:n,onChangeTime:r,scrollToTopLogs:a,visibleRange:l,queries:c,clearCache:d,addResultsToCache:h}=e;const[u,p]=(0,o.useState)([]),[g,f]=(0,o.useState)(0),m=(0,o.useRef)(),y=(0,o.useRef)(),v=(0,o.useRef)(0),x=s===kt.UV.Ascending,b=x?g===u.length-1:0===g,w=x?0===g:g===u.length-1,S=(0,C.l4)(),R=ms(S,x,n);(0,o.useEffect)((()=>{const e={logsRange:l,queryRange:t};let i=[];if((0,O.isEqual)(y.current,t)&&(0,O.isEqual)(m.current,c)){p((t=>(i=t.filter((t=>!(0,O.isEqual)(e.queryRange,t.queryRange))),i=[...i,e].sort(((e,t)=>z(e,t,s))),i)));const o=i.findIndex((e=>e.queryRange.to===t.to));f(o)}else d(),p([e]),f(0),m.current=c,v.current=t.to-t.from;h()}),[l,t,s,c,d,h]),(0,o.useEffect)((()=>{d()}),[]);const j=e=>{let{from:t,to:s}=e;y.current={from:t,to:s},r({from:t,to:s})},z=(e,t,s)=>s===kt.UV.Ascending?e.queryRange.to>t.queryRange.to?1:-1:e.queryRange.to>t.queryRange.to?-1:1,T=(0,ae.jsx)(Lt.zx,{"data-testid":"olderLogsButton",className:R.navButton,variant:"secondary",onClick:()=>{if((0,H.ff)("grafana_explore_logs_pagination_clicked",{pageType:"olderLogsButton"}),w)j({from:l.from-v.current,to:l.from});else{const e=x?-1:1;j({from:u[g+e].queryRange.from,to:u[g+e].queryRange.to})}},disabled:n,children:(0,ae.jsxs)("div",{className:R.navButtonContent,children:[n?hs||(hs=(0,ae.jsx)(as.$,{})):(0,ae.jsx)(ie.J,{name:x?"angle-up":"angle-down",size:"lg"}),"Older logs"]})}),I=(0,ae.jsx)(Lt.zx,{"data-testid":"newerLogsButton",className:R.navButton,variant:"secondary",onClick:()=>{if((0,H.ff)("grafana_explore_logs_pagination_clicked",{pageType:"newerLogsButton"}),!b){const e=x?1:-1;j({from:u[g+e].queryRange.from,to:u[g+e].queryRange.to})}},disabled:n||b,children:(0,ae.jsxs)("div",{className:R.navButtonContent,children:[n&&(us||(us=(0,ae.jsx)(as.$,{}))),b||n?null:(0,ae.jsx)(ie.J,{name:x?"angle-down":"angle-up",size:"lg"}),b?"Start of range":"Newer logs"]})});return(0,ae.jsxs)("div",{className:R.navContainer,children:[x?T:I,(0,ae.jsx)(cs,{pages:u,currentPageIndex:g,oldestLogsFirst:x,timeZone:i,loading:n,changeTime:j}),x?I:T,(0,ae.jsx)(Lt.zx,{"data-testid":"scrollToTop",className:R.scrollToTopButton,variant:"secondary",onClick:a,title:"Scroll to top",children:ps||(ps=(0,ae.jsx)(ie.J,{name:"arrow-up",size:"lg"}))})]})}const fs=(0,o.memo)(gs),ms=(e,t,s)=>({navContainer:i.css`
      max-height: 95vh;
      display: flex;
      flex-direction: column;
      justify-content: ${t?"flex-start":"space-between"};
      position: sticky;
      top: ${e.spacing(2)};
      right: 0;
    `,navButton:i.css`
      width: 58px;
      height: 68px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      line-height: 1;
    `,navButtonContent:i.css`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      white-space: normal;
    `,scrollToTopButton:i.css`
      width: 40px;
      height: 40px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin-top: ${e.spacing(1)};
    `});var ys,vs,xs=s(2843);function bs(e){var t;const[s,i]=(0,o.useState)(!1),n=e.error.message||(null===(t=e.error.data)||void 0===t?void 0:t.message)||"",r=!s&&n.length>100;return(0,ae.jsx)(xs.b,{title:"Failed to load log volume for this query",severity:"warning",children:r?(0,ae.jsx)(Lt.zx,{variant:"secondary",size:"xs",onClick:()=>{i(!0)},children:"Show details"}):n})}function ws(e){const{width:t,timeZone:s,splitOpen:i,onUpdateTimeRange:o,onLoadLogsVolume:n,onHiddenSeriesChanged:r}=e,a=(0,C.l4)(),l=(0,C.wW)(Ss),c=parseInt(a.spacing(2).slice(0,-2),10),d=function(e,t,s,i){return void 0!==s?{logsVolumeData:s,fullRangeData:!0,range:i}:void 0!==e?{logsVolumeData:e,fullRangeData:!1,range:t||i}:void 0}(e.logLinesBasedData,e.logLinesBasedDataVisibleRange,e.logsVolumeData,e.absoluteRange);if(void 0===d)return null;const{logsVolumeData:h,fullRangeData:u,range:p}=d;if(void 0!==h.error)return(0,ae.jsx)(bs,{error:h.error});let g,f;if((null==h?void 0:h.state)===D.Gu.Loading?g=ys||(ys=(0,ae.jsx)("span",{children:"Log volume is loading..."})):null!=h&&h.data&&(g=h.data.length>0?(0,ae.jsx)(le,{graphStyle:"lines",loadingState:D.Gu.Done,data:h.data,height:150,width:t-c,absoluteRange:p,onChangeTime:o,timeZone:s,splitOpenFn:i,tooltipDisplayMode:se.f3.Multi,onHiddenSeriesChanged:r,anchorToZero:!0,eventBus:e.eventBus}):vs||(vs=(0,ae.jsx)("span",{children:"No volume data."}))),u){const e=function(e,t){var s,i;const o=e&&e.data[0]&&(null===(s=e.data[0].meta)||void 0===s||null===(i=s.custom)||void 0===i?void 0:i.absoluteRange);return o?(t.from-t.to)/(o.from-o.to):void 0}(h,p);void 0!==e&&e<1&&(f=(0,ae.jsx)(Vt._,{label:"Reload log volume",transparent:!0,children:(0,ae.jsx)(Lt.zx,{size:"xs",icon:"sync",variant:"secondary",onClick:n,id:"reload-volume"})}))}else f=(0,ae.jsx)("div",{className:l.oldInfoText,children:"This datasource does not support full-range histograms. The graph is based on the logs seen in the response."});return(0,ae.jsxs)(P.U,{label:"",isOpen:!0,children:[(0,ae.jsx)("div",{style:{height:150},className:l.contentContainer,children:g}),(0,ae.jsx)("div",{className:l.extraInfoContainer,children:f})]})}const Ss=e=>({extraInfoContainer:i.css`
      display: flex;
      justify-content: end;
      position: absolute;
      right: 5px;
      top: 5px;
    `,contentContainer:i.css`
      display: flex;
      align-items: center;
      justify-content: center;
    `,oldInfoText:i.css`
      font-size: ${e.typography.size.sm};
      color: ${e.colors.text.secondary};
    `});var Rs=s(27368);function js(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Cs=i.css`
  & > div {
    overflow: visible;
    & > div {
      overflow: visible;
    }
  }
`;class zs extends o.PureComponent{constructor(e){super(e),js(this,"flipOrderTimer",void 0),js(this,"cancelFlippingTimer",void 0),js(this,"topLogsRef",(0,o.createRef)()),js(this,"logsVolumeEventBus",void 0),js(this,"state",{showLabels:T.Z.getBool(Rs.h.showLabels,!1),showTime:T.Z.getBool(Rs.h.showTime,!0),wrapLogMessage:T.Z.getBool(Rs.h.wrapLogMessage,!0),prettifyLogMessage:T.Z.getBool(Rs.h.prettifyLogMessage,!1),dedupStrategy:kt.Y4.none,hiddenLogLevels:[],logsSortOrder:T.Z.get(Rs.h.logsSortOrder)||kt.UV.Descending,isFlipping:!1,showDetectedFields:[],forceEscape:!1}),js(this,"onLogRowHover",(e=>{e?this.props.eventBus.publish(new Wt.es({point:{time:e.timeEpochMs}})):this.props.eventBus.publish(new Wt.xH)})),js(this,"onChangeLogsSortOrder",(()=>{this.setState({isFlipping:!0}),this.flipOrderTimer=window.setTimeout((()=>{this.setState((e=>{const t=e.logsSortOrder===kt.UV.Descending?kt.UV.Ascending:kt.UV.Descending;return T.Z.set(Rs.h.logsSortOrder,t),{logsSortOrder:t}}))}),0),this.cancelFlippingTimer=window.setTimeout((()=>this.setState({isFlipping:!1})),1e3)})),js(this,"onEscapeNewlines",(()=>{this.setState((e=>({forceEscape:!e.forceEscape})))})),js(this,"onChangeDedup",(e=>{(0,H.ff)("grafana_explore_logs_deduplication_clicked",{deduplicationType:e,datasourceType:this.props.datasourceType}),this.setState({dedupStrategy:e})})),js(this,"onChangeLabels",(e=>{const{target:t}=e;if(t){const e=t.checked;this.setState({showLabels:e}),T.Z.set(Rs.h.showLabels,e)}})),js(this,"onChangeTime",(e=>{const{target:t}=e;if(t){const e=t.checked;this.setState({showTime:e}),T.Z.set(Rs.h.showTime,e)}})),js(this,"onChangeWrapLogMessage",(e=>{const{target:t}=e;if(t){const e=t.checked;this.setState({wrapLogMessage:e}),T.Z.set(Rs.h.wrapLogMessage,e)}})),js(this,"onChangePrettifyLogMessage",(e=>{const{target:t}=e;if(t){const e=t.checked;this.setState({prettifyLogMessage:e}),T.Z.set(Rs.h.prettifyLogMessage,e)}})),js(this,"onToggleLogLevel",(e=>{const t=e.map((e=>kt.in[e]));this.setState({hiddenLogLevels:t})})),js(this,"onToggleLogsVolumeCollapse",(e=>{this.props.onSetLogsVolumeEnabled(e),(0,H.ff)("grafana_explore_logs_histogram_toggle_clicked",{datasourceType:this.props.datasourceType,type:e?"open":"close"})})),js(this,"onClickScan",(e=>{e.preventDefault(),this.props.onStartScanning&&this.props.onStartScanning()})),js(this,"onClickStopScan",(e=>{e.preventDefault(),this.props.onStopScanning&&this.props.onStopScanning()})),js(this,"showDetectedField",(e=>{-1===this.state.showDetectedFields.indexOf(e)&&this.setState((t=>({showDetectedFields:t.showDetectedFields.concat(e)})))})),js(this,"hideDetectedField",(e=>{this.state.showDetectedFields.indexOf(e)>-1&&this.setState((t=>({showDetectedFields:t.showDetectedFields.filter((t=>e!==t))})))})),js(this,"clearDetectedFields",(()=>{this.setState((e=>({showDetectedFields:[]})))})),js(this,"checkUnescapedContent",(0,w.Z)((e=>!!e.some((e=>e.hasUnescapedContent))))),js(this,"dedupRows",(0,w.Z)(((e,t)=>{const s=(0,Gt.UW)(e,t),i=s.reduce(((e,t)=>t.duplicates?e+t.duplicates:e),0);return{dedupedRows:s,dedupCount:i}}))),js(this,"filterRows",(0,w.Z)(((e,t)=>(0,Gt.nu)(e,new Set(t))))),js(this,"createNavigationRange",(0,w.Z)((e=>{if(!e||0===e.length)return;const t=e[0].timeEpochMs,s=e[e.length-1].timeEpochMs;return s<t?{from:s,to:t}:{from:t,to:s}}))),js(this,"scrollToTopLogs",(()=>{var e;return null===(e=this.topLogsRef.current)||void 0===e?void 0:e.scrollIntoView()})),this.logsVolumeEventBus=e.eventBus.newScopedBus("logsvolume",{onlyLocal:!1})}componentWillUnmount(){this.flipOrderTimer&&window.clearTimeout(this.flipOrderTimer),this.cancelFlippingTimer&&window.clearTimeout(this.cancelFlippingTimer)}render(){const{width:e,splitOpen:t,logRows:s,logsMeta:i,logsSeries:o,visibleRange:n,logsVolumeEnabled:r,logsVolumeData:a,loadLogsVolumeData:l,loading:c=!1,loadingState:d,onClickFilterLabel:h,onClickFilterOutLabel:u,timeZone:p,scanning:g,scanRange:f,showContextToggle:m,absoluteRange:y,onChangeTime:v,getFieldLinks:x,theme:b,logsQueries:w,clearCache:S,addResultsToCache:R,exploreId:j,scrollElement:C}=this.props,{showLabels:z,showTime:T,wrapLogMessage:I,prettifyLogMessage:k,dedupStrategy:F,hiddenLogLevels:E,logsSortOrder:L,isFlipping:D,showDetectedFields:N,forceEscape:H}=this.state,$=Is(b,I),M=s&&s.length>0,B=this.checkUnescapedContent(s),A=this.filterRows(s,E),{dedupedRows:q,dedupCount:_}=this.dedupRows(A,F),W=this.createNavigationRange(s),Q=f?`Scanning ${Qt.describeTimeRange(f)}`:"Scanning...";return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(P.U,{label:"Logs volume",collapsible:!0,isOpen:r,onToggle:this.onToggleLogsVolumeCollapse,children:r&&(0,ae.jsx)(ws,{absoluteRange:y,width:e,logsVolumeData:a,logLinesBasedData:o?{data:o,state:d}:void 0,logLinesBasedDataVisibleRange:n,onUpdateTimeRange:v,timeZone:p,splitOpen:t,onLoadLogsVolume:()=>l(j),onHiddenSeriesChanged:this.onToggleLogLevel,eventBus:this.logsVolumeEventBus})}),(0,ae.jsxs)(P.U,{label:"Logs",loading:c,isOpen:!0,className:Cs,children:[(0,ae.jsxs)("div",{className:$.logOptions,ref:this.topLogsRef,children:[(0,ae.jsxs)(Zt.Z,{children:[(0,ae.jsx)(Vt._,{label:"Time",className:$.horizontalInlineLabel,transparent:!0,children:(0,ae.jsx)(Ut.x,{value:T,onChange:this.onChangeTime,className:$.horizontalInlineSwitch,transparent:!0,id:`show-time_${j}`})}),(0,ae.jsx)(Vt._,{label:"Unique labels",className:$.horizontalInlineLabel,transparent:!0,children:(0,ae.jsx)(Ut.x,{value:z,onChange:this.onChangeLabels,className:$.horizontalInlineSwitch,transparent:!0,id:`unique-labels_${j}`})}),(0,ae.jsx)(Vt._,{label:"Wrap lines",className:$.horizontalInlineLabel,transparent:!0,children:(0,ae.jsx)(Ut.x,{value:I,onChange:this.onChangeWrapLogMessage,className:$.horizontalInlineSwitch,transparent:!0,id:`wrap-lines_${j}`})}),(0,ae.jsx)(Vt._,{label:"Prettify JSON",className:$.horizontalInlineLabel,transparent:!0,children:(0,ae.jsx)(Ut.x,{value:k,onChange:this.onChangePrettifyLogMessage,className:$.horizontalInlineSwitch,transparent:!0,id:`prettify_${j}`})}),(0,ae.jsx)(Vt._,{label:"Dedup",className:$.horizontalInlineLabel,transparent:!0,children:(0,ae.jsx)(de.S,{options:Object.values(kt.Y4).map((e=>({label:(0,O.capitalize)(e),value:e,description:kt.Uv[e]}))),value:F,onChange:this.onChangeDedup,className:$.radioButtons})})]}),(0,ae.jsx)("div",{children:(0,ae.jsx)(Vt._,{label:"Display results",className:$.horizontalInlineLabel,transparent:!0,children:(0,ae.jsx)(de.S,{disabled:D,options:[{label:"Newest first",value:kt.UV.Descending,description:"Show results newest to oldest"},{label:"Oldest first",value:kt.UV.Ascending,description:"Show results oldest to newest"}],value:L,onChange:this.onChangeLogsSortOrder,className:$.radioButtons})})})]}),(0,ae.jsx)(os,{logRows:s,meta:i||[],dedupStrategy:F,dedupCount:_,hasUnescapedContent:B,forceEscape:H,showDetectedFields:N,onEscapeNewlines:this.onEscapeNewlines,clearDetectedFields:this.clearDetectedFields}),(0,ae.jsxs)("div",{className:$.logsSection,children:[(0,ae.jsx)("div",{className:$.logRows,"data-testid":"logRows",children:(0,ae.jsx)(Kt.w,{logRows:s,deduplicatedRows:q,dedupStrategy:F,getRowContext:this.props.getRowContext,onClickFilterLabel:h,onClickFilterOutLabel:u,showContextToggle:m,showLabels:z,showTime:T,enableLogDetails:!0,forceEscape:H,wrapLogMessage:I,prettifyLogMessage:k,timeZone:p,getFieldLinks:x,logsSortOrder:L,showDetectedFields:N,onClickShowDetectedField:this.showDetectedField,onClickHideDetectedField:this.hideDetectedField,app:fe.zj.Explore,scrollElement:C,onLogRowHover:this.onLogRowHover})}),(0,ae.jsx)(fs,{logsSortOrder:L,visibleRange:null!=W?W:y,absoluteRange:y,timeZone:p,onChangeTime:v,loading:c,queries:null!=w?w:[],scrollToTopLogs:this.scrollToTopLogs,addResultsToCache:R,clearCache:S})]}),!c&&!M&&!g&&(0,ae.jsxs)("div",{className:$.noData,children:["No logs found.",(0,ae.jsx)(Lt.zx,{size:"xs",fill:"text",onClick:this.onClickScan,children:"Scan for older logs"})]}),g&&(0,ae.jsxs)("div",{className:$.noData,children:[(0,ae.jsx)("span",{children:Q}),(0,ae.jsx)(Lt.zx,{size:"xs",fill:"text",onClick:this.onClickStopScan,children:"Stop scan"})]})]})]})}}const Ts=(0,C.HE)(zs),Is=(e,t)=>({noData:i.css`
      > * {
        margin-left: 0.5em;
      }
    `,logOptions:i.css`
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      flex-wrap: wrap;
      background-color: ${e.colors.background.primary};
      padding: ${e.spacing(1,2)};
      border-radius: ${e.shape.borderRadius()};
      margin: ${e.spacing(0,0,1)};
      border: 1px solid ${e.colors.border.medium};
    `,headerButton:i.css`
      margin: ${e.spacing(.5,0,0,1)};
    `,horizontalInlineLabel:i.css`
      > label {
        margin-right: 0;
      }
    `,horizontalInlineSwitch:i.css`
      padding: 0 ${e.spacing(1)} 0 0;
    `,radioButtons:i.css`
      margin: 0;
    `,logsSection:i.css`
      display: flex;
      flex-direction: row;
      justify-content: space-between;
    `,logRows:i.css`
      overflow-x: ${t?"unset":"scroll"};
      overflow-y: visible;
      width: 100%;
    `}),ks=(0,w.Z)((()=>({logsEnter:i.css`
      label: logsEnter;
      position: absolute;
      opacity: 0;
      height: auto;
      width: 100%;
    `,logsEnterActive:i.css`
      label: logsEnterActive;
      opacity: 1;
      transition: opacity ${500}ms ease-out ${100}ms;
    `,logsExit:i.css`
      label: logsExit;
      position: absolute;
      opacity: 1;
      height: auto;
      width: 100%;
    `,logsExitActive:i.css`
      label: logsExitActive;
      opacity: 0;
      transition: opacity ${500}ms ease-out ${100}ms;
    `})));function Fs(e){const{visible:t,children:s}=e,i=ks();return(0,ae.jsx)(gt.Z,{in:t,mountOnEnter:!0,unmountOnExit:!0,timeout:600,classNames:{enter:i.logsEnter,enterActive:i.logsEnterActive,exit:i.logsExit,exitActive:i.logsExitActive},children:s})}var Es=s(1814);function Os(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ls extends o.PureComponent{constructor(){super(...arguments),Os(this,"onChangeTime",(e=>{const{exploreId:t,updateTimeRange:s}=this.props;s({exploreId:t,absoluteRange:e})})),Os(this,"getLogRowContext",(async(e,t)=>{const{datasourceInstance:s,logsQueries:i}=this.props;if((0,kt.Q4)(s)){const o=(null!=i?i:[]).find((t=>t.refId===e.dataFrame.refId&&null!=t.datasource&&t.datasource.type===s.type));return s.getLogRowContext(e,t,o)}return[]})),Os(this,"showContextToggle",(e=>{const{datasourceInstance:t}=this.props;return!!(0,kt.Q4)(t)&&t.showContextToggle(e)})),Os(this,"getFieldLinks",((e,t,s)=>{const{splitOpenFn:i,range:o}=this.props;return(0,Es.a)({field:e,rowIndex:t,splitOpenFn:i,range:o,dataFrame:s})}))}render(){var e;const{loading:t,loadingState:s,logRows:i,logsMeta:o,logsSeries:n,logsQueries:r,logsVolumeData:a,loadLogsVolumeData:l,onClickFilterLabel:c,onClickFilterOutLabel:d,onStartScanning:h,onStopScanning:u,absoluteRange:p,timeZone:g,visibleRange:f,scanning:m,range:y,width:v,splitOpenFn:x,isLive:b,exploreId:w,addResultsToCache:S,clearCache:R,scrollElement:j}=this.props;return i?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(Fs,{visible:b,children:(0,ae.jsx)(P.U,{label:"Logs",loading:!1,isOpen:!0,children:(0,ae.jsx)(bt,{exploreId:w,children:e=>(0,ae.jsx)(_t,{logRows:i,timeZone:g,stopLive:e.stop,isPaused:this.props.isPaused,onPause:e.pause,onResume:e.resume})})})}),(0,ae.jsx)(Fs,{visible:!b,children:(0,ae.jsx)(Ts,{exploreId:w,datasourceType:null===(e=this.props.datasourceInstance)||void 0===e?void 0:e.type,logRows:i,logsMeta:o,logsSeries:n,logsVolumeEnabled:this.props.logsVolumeEnabled,onSetLogsVolumeEnabled:e=>this.props.setLogsVolumeEnabled(w,e),logsVolumeData:a,logsQueries:r,width:v,splitOpen:x,loading:t,loadingState:s,loadLogsVolumeData:l,onChangeTime:this.onChangeTime,onClickFilterLabel:c,onClickFilterOutLabel:d,onStartScanning:h,onStopScanning:u,absoluteRange:p,visibleRange:f,timeZone:g,scanning:m,scanRange:y.raw,showContextToggle:this.showContextToggle,getRowContext:this.getLogRowContext,getFieldLinks:this.getFieldLinks,addResultsToCache:()=>S(w),clearCache:()=>R(w),scrollElement:j,eventBus:this.props.eventBus})})]}):null}}const Ds={updateTimeRange:xt.cD,addResultsToCache:v.K8,clearCache:v.LK,loadLogsVolumeData:v.QH,setLogsVolumeEnabled:v.t0},Ns=(0,S.connect)((function(e,t){let{exploreId:s}=t;const i=e.explore[s],{logsResult:o,loading:n,scanning:r,datasourceInstance:a,isLive:l,isPaused:c,range:d,absoluteRange:h,logsVolumeEnabled:u,logsVolumeDataProvider:p,logsVolumeData:g}=i,f=(0,E.Z)(e.user);return{loading:n,logRows:null==o?void 0:o.rows,logsMeta:null==o?void 0:o.meta,logsSeries:null==o?void 0:o.series,logsQueries:null==o?void 0:o.queries,visibleRange:null==o?void 0:o.visibleRange,scanning:r,timeZone:f,datasourceInstance:a,isLive:l,isPaused:c,range:d,absoluteRange:h,logsVolumeEnabled:u,logsVolumeDataProvider:p,logsVolumeData:g}}),Ds)(Ls),Hs=()=>{const e=(0,C.wW)($s);return(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsx)(B.l,{"data-testid":"explore-no-data",className:e.wrapper,children:(0,ae.jsx)("span",{className:e.message,children:"No data"})})})},$s=e=>({wrapper:i.css`
    label: no-data-card;
    padding: ${e.spacing(3)};
    background: ${e.colors.background.primary};
    border-radius: ${e.shape.borderRadius(2)};
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex-grow: 1;
  `,message:i.css`
    font-size: ${e.typography.h2.fontSize};
    padding: ${e.spacing(4)};
    color: ${e.colors.text.disabled};
  `});var Ps,Ms,Bs=s(334);const As=()=>{const e=(0,C.l4)(),t=st.Vt.hasPermission(u.bW.DataSourcesCreate)&&st.Vt.hasPermission(u.bW.DataSourcesWrite),s=(0,ae.jsxs)(ae.Fragment,{children:[Ps||(Ps=(0,ae.jsx)(ie.J,{name:"rocket"})),(0,ae.jsx)(ae.Fragment,{children:" ProTip: You can also define data sources through configuration files. "}),Ms||(Ms=(0,ae.jsx)("a",{href:"http://docs.grafana.org/administration/provisioning/#datasources?utm_source=explore",target:"_blank",rel:"noreferrer",className:"text-link",children:"Learn more"}))]}),o=(0,ae.jsx)(Lt.Qj,{size:"lg",href:"datasources/new",icon:"database",disabled:!t,children:"Add data source"}),n=i.css`
    max-width: ${e.breakpoints.values.lg}px;
    margin-top: ${e.spacing(2)};
    align-self: center;
  `;return(0,ae.jsx)(Bs._,{callToActionElement:o,className:n,footer:s,message:"Explore requires at least one data source. Once you have added a data source, you can query it here."})};var qs,_s=s(88102),Ws=s(6663),Qs=s(64313),Zs=s(81434),Vs=s(90009);const Us=e=>({warningText:i.css`
    label: warningText;
    font-size: ${e.typography.bodySmall.fontSize};
    color: ${e.colors.text.secondary};
  `});const Gs=(0,S.connect)((function(e,t){let{exploreId:s}=t;return{range:e.explore[s].range}}),{})((function(e){var t;const{dataFrames:s,range:i,splitOpenFn:n,withTraceView:r,datasourceType:a}=e,l=(0,Es.u)(i,n),c=(0,C.l4)(),d=(0,C.wW)(Us),h=(0,J.SM)({fieldConfig:{defaults:{},overrides:[]},data:s,replaceVariables:e=>e,theme:c}),{nodes:u}=(0,Vs.Y)(h),[p,g]=(0,_s.Z)(!1),{height:f}=(0,Ws.Z)(),m=(0,o.useRef)(null),[y,v]=(0,o.useState)(250);(0,o.useEffect)((()=>{if(m.current){const{top:e}=m.current.getBoundingClientRect();v(e)}}),[m]);const x=f-y-32,b=r&&(null===(t=u[0])||void 0===t?void 0:t.length)>1e3?(0,ae.jsxs)("span",{className:d.warningText,children:[" (",u[0].length," nodes, can be slow to load)"]}):null;return(0,ae.jsx)(P.U,{label:(0,ae.jsxs)("span",{children:["Node graph",b," ",qs||(qs=(0,ae.jsx)(Qs.C,{text:"Beta",color:"blue",icon:"rocket",tooltip:"This visualization is in beta"}))]}),collapsible:r,isOpen:!r||p,onToggle:r?()=>(g(),void(0,H.ff)("grafana_traces_node_graph_panel_clicked",{datasourceType:a,expanded:!p})):void 0,children:(0,ae.jsx)("div",{ref:m,style:r?{height:500}:{minHeight:600,height:x},children:(0,ae.jsx)(Zs.E,{dataFrames:h,getLinks:l})})})}));var Ks=s(4387),Ys=s(52253),Js=s(60796);const Xs=e=>{let{exploreId:t}=e;const s=(0,u.I0)(),{getQueries:i,getDatasourceInstanceSettings:n,getQueryResponse:r,getHistory:a,getEventBridge:l}=(0,o.useMemo)((()=>(e=>{const t=(0,x.F)(e);return{getQueries:(0,Ks.P1)(t,(e=>e.queries)),getQueryResponse:(0,Ks.P1)(t,(e=>e.queryResponse)),getHistory:(0,Ks.P1)(t,(e=>e.history)),getEventBridge:(0,Ks.P1)(t,(e=>e.eventBridge)),getDatasourceInstanceSettings:(0,Ks.P1)(t,(e=>{var t;return(0,F.ak)().getInstanceSettings(null===(t=e.datasourceInstance)||void 0===t?void 0:t.uid)}))}})(t)),[t]),c=(0,u.v9)(i),d=(0,u.v9)(n),h=(0,u.v9)(r),p=(0,u.v9)(a),g=(0,u.v9)(l),f=(0,o.useCallback)((()=>{s((0,v.aA)(t))}),[s,t]),m=(0,o.useCallback)((e=>{s((0,v.PM)({queries:e,exploreId:t})),e.length<c.length&&f()}),[s,t,f,c]),y=(0,o.useCallback)((e=>{m([...c,Object.assign({},e,{refId:(0,Ys.Hs)(c)})])}),[m,c]);return(0,ae.jsx)(Js.l,{dsSettings:d,onDatasourceChange:(e,i)=>(async(e,i)=>{const o=await(0,N.F)().get(i.datasource),n=await(0,N.F)().get({uid:e.uid});s((0,v.GJ)(t,c,o,n,i.refId))})(e,i),queries:c,onQueriesChange:m,onAddQuery:y,onRunQueries:f,onQueryCopied:()=>{(0,H.ff)("grafana_explore_query_row_copy")},onQueryRemoved:()=>{(0,H.ff)("grafana_explore_query_row_remove")},onQueryToggled:e=>{(0,H.ff)("grafana_query_row_toggle",void 0===e?{}:{queryEnabled:e})},data:h,app:fe.zj.Explore,history:p,eventBus:g})};var ei=s(41141);const ti=e=>{const t={transition:`opacity ${e.duration}ms linear`,opacity:0},s={exited:{opacity:0,display:"none"},entering:{opacity:0},entered:{opacity:1},exiting:{opacity:0}};return(0,ae.jsx)(ei.ZP,{in:e.in,timeout:e.duration,unmountOnExit:e.unmountOnExit||!1,onExited:e.onExited,children:i=>(0,ae.jsx)("div",{style:Object.assign({},t,s[i]),children:e.children})})},si=e=>{var t;const{queryError:s}=e,i=!!s,o=i?100:10,n=s?"Query error":"Unknown error",r=(null==s?void 0:s.message)||(null==s||null===(t=s.data)||void 0===t?void 0:t.message)||null;return(0,ae.jsx)(ti,{in:i,duration:o,children:(0,ae.jsx)(xs.b,{severity:"error",title:n,topSpacing:2,children:r})})};function ii(e){const t=(0,u.v9)((t=>{var s;return null===(s=t.explore[e.exploreId])||void 0===s?void 0:s.queryResponse})),s=(null==t?void 0:t.state)===D.Gu.Error?null==t?void 0:t.error:void 0;return null!=s&&s.refId?null:(0,ae.jsx)(si,{queryError:s})}var oi=s(97526),ni=s(36501),ri=s(40773),ai=s(70917),li=s(39106),ci=s(93194),di=s(23734),hi=s(93686),ui=s(63454);const pi={changeDatasource:vt.zU,deleteHistoryItem:oi.NV,commentHistoryItem:oi.Ff,starHistoryItem:oi.ev,setQueries:v.KO},gi=(0,S.connect)((function(e,t){let{exploreId:s}=t;const i=e.explore,{datasourceInstance:o}=i[s];return{exploreId:s,datasourceInstance:o}}),pi),fi=e=>{const t="240px",s="170px",o=e.colors.background.secondary;return{queryCard:i.css`
      display: flex;
      flex-direction: column;
      border: 1px solid ${e.colors.border.weak};
      margin: ${e.spacing(1)} 0;
      background-color: ${o};
      border-radius: ${e.shape.borderRadius(1)};
      .starred {
        color: ${e.v1.palette.orange};
      }
    `,cardRow:i.css`
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: ${e.spacing(1)};
      border-bottom: none;
      :first-of-type {
        border-bottom: 1px solid ${e.colors.border.weak};
        padding: ${e.spacing(.5,1)};
      }
      img {
        height: ${e.typography.fontSize}px;
        max-width: ${e.typography.fontSize}px;
        margin-right: ${e.spacing(1)};
      }
    `,datasourceContainer:i.css`
      display: flex;
      align-items: center;
      font-size: ${e.typography.bodySmall.fontSize};
      font-weight: ${e.typography.fontWeightMedium};
    `,queryActionButtons:i.css`
      max-width: ${s};
      display: flex;
      justify-content: flex-end;
      font-size: ${e.typography.size.base};
      button {
        margin-left: ${e.spacing(1)};
      }
    `,queryContainer:i.css`
      font-weight: ${e.typography.fontWeightMedium};
      width: calc(100% - ${t});
    `,queryRow:i.css`
      border-top: 1px solid ${e.colors.border.weak};
      word-break: break-all;
      padding: 4px 2px;
      :first-child {
        border-top: none;
        padding: 0 0 4px 0;
      }
    `,updateCommentContainer:i.css`
      width: calc(100% + ${t});
      margin-top: ${e.spacing(1)};
    `,comment:i.css`
      overflow-wrap: break-word;
      font-size: ${e.typography.bodySmall.fontSize};
      font-weight: ${e.typography.fontWeightRegular};
      margin-top: ${e.spacing(.5)};
    `,commentButtonRow:i.css`
      > * {
        margin-right: ${e.spacing(1)};
      }
    `,textArea:i.css`
      width: 100%;
    `,runButton:i.css`
      max-width: ${s};
      display: flex;
      justify-content: flex-end;
      button {
        height: auto;
        padding: ${e.spacing(.5,2)};
        line-height: 1.4;
        span {
          white-space: normal !important;
        }
      }
    `}};const mi=gi((function(e){var t;const{query:s,dsImg:n,isRemoved:r,commentHistoryItem:a,starHistoryItem:l,deleteHistoryItem:d,changeDatasource:h,exploreId:u,datasourceInstance:p,setQueries:g}=e,[f,m]=(0,o.useState)(!1),[y,v]=(0,o.useState)(s.comment),[x,b]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{(async()=>{const e=await(0,N.F)().get(s.datasourceUid);b(e)})()}),[s.datasourceUid]);const w=(0,C.wW)(fi),S=()=>{a(s.id,y),m(!1),(0,H.ff)("grafana_explore_query_history_commented",{queryHistoryEnabled:$.v.queryHistoryEnabled})},R=()=>{m(!1),v(s.comment)},j=(0,ae.jsxs)("div",{className:w.updateCommentContainer,"aria-label":y?"Update comment form":"Add comment form",children:[(0,ae.jsx)(ci.K,{value:y,placeholder:y?void 0:"An optional description of what the query does.",onChange:e=>v(e.currentTarget.value),className:w.textArea}),(0,ae.jsxs)("div",{className:w.commentButtonRow,children:[(0,ae.jsx)(Lt.zx,{onClick:S,"aria-label":"Submit button",children:"Save comment"}),(0,ae.jsx)(Lt.zx,{variant:"secondary",onClick:R,children:"Cancel"})]})]}),z=(0,ae.jsxs)("div",{className:w.queryActionButtons,children:[(0,ae.jsx)(di.h,{name:"comment-alt",onClick:()=>m(!f),title:(null===(t=s.comment)||void 0===t?void 0:t.length)>0?"Edit comment":"Add comment"}),(0,ae.jsx)(di.h,{name:"copy",onClick:()=>{const e=s.queries.map((e=>(0,ni.OH)(e,x))).join("\n");(0,I.n9)(e),(0,ui.WI)((0,hi.$l)((0,c.AT)("Query copied to clipboard")))},title:"Copy query to clipboard"}),!r&&(0,ae.jsx)(di.h,{name:"share-alt",onClick:async()=>{const e=(0,ni.t2)(s);await(0,it.L)(e)},title:"Copy shortened link to clipboard"}),(0,ae.jsx)(di.h,{name:"trash-alt",title:"Delete query",onClick:()=>{const e=e=>{d(e),(0,ui.WI)((0,hi.$l)((0,c.AT)("Query deleted"))),(0,H.ff)("grafana_explore_query_history_deleted",{queryHistoryEnabled:$.v.queryHistoryEnabled})};s.starred?q.Z.publish(new Q.VJ({title:"Delete",text:"Are you sure you want to permanently delete your starred query?",yesText:"Delete",icon:"trash-alt",onConfirm:()=>e(s.id)})):e(s.id)}}),(0,ae.jsx)(di.h,{name:s.starred?"favorite":"star",iconType:s.starred?"mono":"default",onClick:()=>{l(s.id,!s.starred),(0,H.ff)("grafana_explore_query_history_starred",{queryHistoryEnabled:$.v.queryHistoryEnabled,newValue:!s.starred})},title:s.starred?"Unstar query":"Star query"})]});return(0,ae.jsxs)("div",{className:w.queryCard,onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey||e.ctrlKey)&&S(),"Escape"===e.key&&R()},children:[(0,ae.jsxs)("div",{className:w.cardRow,children:[(0,ae.jsxs)("div",{className:w.datasourceContainer,children:[(0,ae.jsx)("img",{src:n,"aria-label":"Data source icon"}),(0,ae.jsx)("div",{"aria-label":"Data source name",children:r?"Data source does not exist anymore":s.datasourceName})]}),z]}),(0,ae.jsxs)("div",{className:(0,i.cx)(w.cardRow),children:[(0,ae.jsxs)("div",{className:w.queryContainer,children:[s.queries.map(((e,t)=>{const s=(0,ni.OH)(e,x);return(0,ae.jsx)("div",{"aria-label":"Query text",className:w.queryRow,children:s},`${e}-${t}`)})),!f&&s.comment&&(0,ae.jsx)("div",{"aria-label":"Query comment",className:w.comment,children:s.comment}),f&&j]}),!f&&(0,ae.jsx)("div",{className:w.runButton,children:(0,ae.jsx)(Lt.zx,{variant:"secondary",onClick:async()=>{const e=s.queries,t=s.datasourceUid!==(null==p?void 0:p.uid);t?(await h(u,s.datasourceUid,{importQueries:!0}),g(u,e)):g(u,e),(0,H.ff)("grafana_explore_query_history_run",{queryHistoryEnabled:$.v.queryHistoryEnabled,differentDataSource:t})},disabled:r,children:(null==p?void 0:p.uid)===s.datasourceUid?"Run query":"Switch data source and run query"})})]})]})}));var yi,vi;function xi(e){const{queries:t,totalQueries:s,loading:n,richHistorySearchFilters:r,updateFilters:a,clearRichHistoryResults:l,loadMoreRichHistory:c,richHistorySettings:d,exploreId:h,height:u,activeDatasourceInstance:p}=e,g=(0,C.wW)((0,o.useCallback)((e=>((e,t)=>{const s=e.isLight?e.v1.palette.gray5:e.v1.palette.dark4;return{container:i.css`
      display: flex;
    `,labelSlider:i.css`
      font-size: ${e.typography.bodySmall.fontSize};
      &:last-of-type {
        margin-top: ${e.spacing(3)};
      }
      &:first-of-type {
        font-weight: ${e.typography.fontWeightMedium};
        margin-bottom: ${e.spacing(2)};
      }
    `,containerContent:i.css`
      /* 134px is based on the width of the Query history tabs bar, so the content is aligned to right side of the tab */
      width: calc(100% - 134px);
    `,containerSlider:i.css`
      width: 129px;
      margin-right: ${e.spacing(1)};
    `,fixedSlider:i.css`
      position: fixed;
    `,slider:i.css`
      bottom: 10px;
      height: ${t-180}px;
      width: 129px;
      padding: ${e.spacing(1)} 0;
    `,selectors:i.css`
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    `,filterInput:i.css`
      margin-bottom: ${e.spacing(1)};
    `,multiselect:i.css`
      width: 100%;
      margin-bottom: ${e.spacing(1)};
      .gf-form-select-box__multi-value {
        background-color: ${s};
        padding: ${e.spacing(.25,.5,.25,1)};
        border-radius: ${e.shape.borderRadius(1)};
      }
    `,sort:i.css`
      width: 170px;
    `,sessionName:i.css`
      display: flex;
      align-items: flex-start;
      justify-content: flex-start;
      margin-top: ${e.spacing(3)};
      h4 {
        margin: 0 10px 0 0;
      }
    `,heading:i.css`
      font-size: ${e.typography.h4.fontSize};
      margin: ${e.spacing(2,.25,1,.25)};
    `,footer:i.css`
      height: 60px;
      margin: ${e.spacing(3)} auto;
      display: flex;
      justify-content: center;
      font-weight: ${e.typography.fontWeightLight};
      font-size: ${e.typography.bodySmall.fontSize};
      a {
        font-weight: ${e.typography.fontWeightMedium};
        margin-left: ${e.spacing(.25)};
      }
    `,queries:i.css`
      font-size: ${e.typography.bodySmall.fontSize};
      font-weight: ${e.typography.fontWeightRegular};
      margin-left: ${e.spacing(.5)};
    `}})(e,u)),[u])),f=(0,ni.DR)();if((0,o.useEffect)((()=>{const e=!d.activeDatasourceOnly&&d.lastUsedDatasourceFilters?d.lastUsedDatasourceFilters:[p],t={search:"",sortOrder:ni.As.Descending,datasourceFilters:e,from:0,to:d.retentionPeriod,starred:!1};return a(t),()=>{l()}}),[]),!r)return yi||(yi=(0,ae.jsx)("span",{children:"Loading..."}));const m=(0,ni.k4)(t,r.sortOrder),y=Ei(),v=t.length&&t.length!==s;return(0,ae.jsxs)("div",{className:g.container,children:[(0,ae.jsx)("div",{className:g.containerSlider,children:(0,ae.jsxs)("div",{className:g.fixedSlider,children:[(0,ae.jsx)("div",{className:g.labelSlider,children:"Filter history"}),(0,ae.jsx)("div",{className:g.labelSlider,children:(0,ni.bQ)(r.from)}),(0,ae.jsx)("div",{className:g.slider,children:(0,ae.jsx)(ri.U,{tooltipAlwaysVisible:!1,min:0,max:d.retentionPeriod,value:[r.from,r.to],orientation:"vertical",formatTooltipResult:ni.bQ,reverse:!0,onAfterChange:e=>{a({from:e[0],to:e[1]})}})}),(0,ae.jsx)("div",{className:g.labelSlider,children:(0,ni.bQ)(r.to)})]})}),(0,ae.jsxs)("div",{className:g.containerContent,children:[(0,ae.jsxs)("div",{className:g.selectors,children:[!d.activeDatasourceOnly&&(0,ae.jsx)(ai.NU,{className:g.multiselect,options:f.map((e=>({value:e.name,label:e.name}))),value:r.datasourceFilters,placeholder:"Filter queries for data sources(s)","aria-label":"Filter queries for data sources(s)",onChange:e=>{a({datasourceFilters:e.map((e=>e.value))})}}),(0,ae.jsx)("div",{className:g.filterInput,children:(0,ae.jsx)(li.H,{placeholder:"Search queries",value:r.search,onChange:e=>a({search:e})})}),(0,ae.jsx)("div",{"aria-label":"Sort queries",className:g.sort,children:(0,ae.jsx)(ai.Ph,{value:y.filter((e=>e.value===r.sortOrder)),options:y,placeholder:"Sort queries by",onChange:e=>a({sortOrder:e.value})})})]}),n&&(vi||(vi=(0,ae.jsx)("span",{children:"Loading results..."}))),!n&&Object.keys(m).map((e=>(0,ae.jsxs)("div",{children:[(0,ae.jsxs)("div",{className:g.heading,children:[e," ",(0,ae.jsxs)("span",{className:g.queries,children:[v?"Displaying ":"",m[e].length," queries"]})]}),m[e].map((e=>{const t=f.findIndex((t=>t.uid===e.datasourceUid));return(0,ae.jsx)(mi,{query:e,exploreId:h,dsImg:-1===t?"public/img/icn-datasource.svg":f[t].imgUrl,isRemoved:-1===t},e.id)}))]},e))),v?(0,ae.jsxs)("div",{children:["Showing ",t.length," of ",s," ",(0,ae.jsx)(Lt.zx,{onClick:c,children:"Load more"})]}):null,(0,ae.jsx)("div",{className:g.footer,children:$.v.queryHistoryEnabled?"":"The history is local to your browser and is not shared with others."})]})]})}var bi=s(65678),wi=s(53018);const Si=e=>({container:i.css`
      font-size: ${e.typography.bodySmall.fontSize};
    `,spaceBetween:i.css`
      margin-bottom: ${e.spacing(3)};
    `,input:i.css`
      max-width: 200px;
    `,bold:i.css`
      font-weight: ${e.typography.fontWeightBold};
    `,bottomMargin:i.css`
      margin-bottom: ${e.spacing(1)};
    `}),Ri=[{value:2,label:"2 days"},{value:5,label:"5 days"},{value:7,label:"1 week"},{value:14,label:"2 weeks"}];function ji(e){const{retentionPeriod:t,starredTabAsFirstTab:s,activeDatasourceOnly:i,onChangeRetentionPeriod:o,toggleStarredTabAsFirstTab:n,toggleactiveDatasourceOnly:r,deleteRichHistory:a}=e,l=(0,C.wW)(Si),d=Ri.find((e=>e.value===t));return(0,ae.jsxs)("div",{className:l.container,children:[(0,_.X)().changeRetention?(0,ae.jsx)(bi.g,{label:"History time span",description:`Select the period of time for which Grafana will save your query history. Up to ${wi.H6} entries will be stored.`,children:(0,ae.jsx)("div",{className:l.input,children:(0,ae.jsx)(ai.Ph,{value:d,options:Ri,onChange:o})})}):(0,ae.jsxs)(xs.b,{severity:"info",title:"History time span",children:["Grafana will keep entries up to ",null==d?void 0:d.label,"."]}),(0,ae.jsx)(Vt._,{label:"Change the default active tab from “Query history” to “Starred”",className:l.spaceBetween,children:(0,ae.jsx)(Ut.x,{id:"explore-query-history-settings-default-active-tab",value:s,onChange:n})}),(0,_.X)().onlyActiveDataSource&&(0,ae.jsx)(Vt._,{label:"Only show queries for data source currently active in Explore",className:l.spaceBetween,children:(0,ae.jsx)(Ut.x,{id:"explore-query-history-settings-data-source-behavior",value:i,onChange:r})}),(0,_.X)().clearHistory&&(0,ae.jsxs)("div",{children:[(0,ae.jsx)("div",{className:l.bold,children:"Clear query history"}),(0,ae.jsx)("div",{className:l.bottomMargin,children:"Delete all of your query history, permanently."}),(0,ae.jsx)(Lt.zx,{variant:"destructive",onClick:()=>{q.Z.publish(new Q.VJ({title:"Delete",text:"Are you sure you want to permanently delete your query history?",yesText:"Delete",icon:"trash-alt",onConfirm:()=>{a(),(0,ui.WI)((0,hi.$l)((0,c.AT)("Query history deleted")))}}))},children:"Clear query history"})]})]})}var Ci,zi;const Ti=e=>{const t=e.isLight?e.v1.palette.gray5:e.v1.palette.dark4;return{container:i.css`
      display: flex;
    `,containerContent:i.css`
      width: 100%;
    `,selectors:i.css`
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    `,multiselect:i.css`
      width: 100%;
      margin-bottom: ${e.spacing(1)};
      .gf-form-select-box__multi-value {
        background-color: ${t};
        padding: ${e.spacing(.25,.5,.25,1)};
        border-radius: ${e.shape.borderRadius(1)};
      }
    `,filterInput:i.css`
      margin-bottom: ${e.spacing(1)};
    `,sort:i.css`
      width: 170px;
    `,footer:i.css`
      height: 60px;
      margin-top: ${e.spacing(3)};
      display: flex;
      justify-content: center;
      font-weight: ${e.typography.fontWeightLight};
      font-size: ${e.typography.bodySmall.fontSize};
      a {
        font-weight: ${e.typography.fontWeightMedium};
        margin-left: ${e.spacing(.25)};
      }
    `}};function Ii(e){const{updateFilters:t,clearRichHistoryResults:s,loadMoreRichHistory:i,activeDatasourceInstance:n,richHistorySettings:r,queries:a,totalQueries:l,loading:c,richHistorySearchFilters:d,exploreId:h}=e,u=(0,C.wW)(Ti),p=(0,ni.DR)();if((0,o.useEffect)((()=>{const e=r.activeDatasourceOnly&&r.lastUsedDatasourceFilters?r.lastUsedDatasourceFilters:[n],i={search:"",sortOrder:ni.As.Descending,datasourceFilters:e,from:0,to:r.retentionPeriod,starred:!0};return t(i),()=>{s()}}),[]),!d)return Ci||(Ci=(0,ae.jsx)("span",{children:"Loading..."}));const g=Ei();return(0,ae.jsx)("div",{className:u.container,children:(0,ae.jsxs)("div",{className:u.containerContent,children:[(0,ae.jsxs)("div",{className:u.selectors,children:[!r.activeDatasourceOnly&&(0,ae.jsx)(ai.NU,{className:u.multiselect,options:p.map((e=>({value:e.name,label:e.name}))),value:d.datasourceFilters,placeholder:"Filter queries for data sources(s)","aria-label":"Filter queries for data sources(s)",onChange:e=>{t({datasourceFilters:e.map((e=>e.value))})}}),(0,ae.jsx)("div",{className:u.filterInput,children:(0,ae.jsx)(li.H,{placeholder:"Search queries",value:d.search,onChange:e=>t({search:e})})}),(0,ae.jsx)("div",{"aria-label":"Sort queries",className:u.sort,children:(0,ae.jsx)(ai.Ph,{value:g.filter((e=>e.value===d.sortOrder)),options:g,placeholder:"Sort queries by",onChange:e=>t({sortOrder:e.value})})})]}),c&&(zi||(zi=(0,ae.jsx)("span",{children:"Loading results..."}))),!c&&a.map((e=>{const t=p.findIndex((t=>t.uid===e.datasourceUid));return(0,ae.jsx)(mi,{query:e,exploreId:h,dsImg:-1===t?"public/img/icn-datasource.svg":p[t].imgUrl,isRemoved:-1===t},e.id)})),a.length&&a.length!==l?(0,ae.jsxs)("div",{children:["Showing ",a.length," of ",l," ",(0,ae.jsx)(Lt.zx,{onClick:i,children:"Load more"})]}):null,(0,ae.jsx)("div",{className:u.footer,children:$.v.queryHistoryEnabled?"":"The history is local to your browser and is not shared with others."})]})})}function ki(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let Fi;!function(e){e.RichHistory="Query history",e.Starred="Starred",e.Settings="Settings"}(Fi||(Fi={}));const Ei=()=>[{label:"Newest first",value:ni.As.Descending},{label:"Oldest first",value:ni.As.Ascending},{label:"Data source A-Z",value:ni.As.DatasourceAZ},{label:"Data source Z-A",value:ni.As.DatasourceZA}].filter((e=>(0,_.X)().availableFilters.includes(e.value)));class Oi extends o.PureComponent{constructor(){super(...arguments),ki(this,"state",{loading:!1}),ki(this,"updateSettings",(e=>{this.props.updateHistorySettings(Object.assign({},this.props.richHistorySettings,e))})),ki(this,"updateFilters",(e=>{const t=Object.assign({},this.props.richHistorySearchFilters,e,{page:1});this.props.updateHistorySearchFilters(this.props.exploreId,t),this.loadRichHistory()})),ki(this,"clearResults",(()=>{this.props.clearRichHistoryResults(this.props.exploreId)})),ki(this,"loadRichHistory",(0,O.debounce)((()=>{this.props.loadRichHistory(this.props.exploreId),this.setState({loading:!0})}),300)),ki(this,"onChangeRetentionPeriod",(e=>{void 0!==e.value&&this.updateSettings({retentionPeriod:e.value})})),ki(this,"toggleStarredTabAsFirstTab",(()=>this.updateSettings({starredTabAsFirstTab:!this.props.richHistorySettings.starredTabAsFirstTab}))),ki(this,"toggleActiveDatasourceOnly",(()=>this.updateSettings({activeDatasourceOnly:!this.props.richHistorySettings.activeDatasourceOnly})))}componentDidUpdate(e,t,s){e.richHistory!==this.props.richHistory&&this.setState({loading:!1})}render(){const{richHistory:e,richHistoryTotal:t,height:s,exploreId:i,deleteRichHistory:o,onClose:n,firstTab:r,activeDatasourceInstance:a}=this.props,{loading:l}=this.state;let c=[{label:"Query history",value:Fi.RichHistory,content:(0,ae.jsx)(xi,{queries:e,totalQueries:t||0,loading:l,updateFilters:this.updateFilters,clearRichHistoryResults:()=>this.props.clearRichHistoryResults(this.props.exploreId),loadMoreRichHistory:()=>this.props.loadMoreRichHistory(this.props.exploreId),activeDatasourceInstance:a,richHistorySettings:this.props.richHistorySettings,richHistorySearchFilters:this.props.richHistorySearchFilters,exploreId:i,height:s}),icon:"history"},{label:"Starred",value:Fi.Starred,content:(0,ae.jsx)(Ii,{queries:e,totalQueries:t||0,loading:l,activeDatasourceInstance:a,updateFilters:this.updateFilters,clearRichHistoryResults:()=>this.props.clearRichHistoryResults(this.props.exploreId),loadMoreRichHistory:()=>this.props.loadMoreRichHistory(this.props.exploreId),richHistorySettings:this.props.richHistorySettings,richHistorySearchFilters:this.props.richHistorySearchFilters,exploreId:i}),icon:"star"},{label:"Settings",value:Fi.Settings,content:(0,ae.jsx)(ji,{retentionPeriod:this.props.richHistorySettings.retentionPeriod,starredTabAsFirstTab:this.props.richHistorySettings.starredTabAsFirstTab,activeDatasourceOnly:this.props.richHistorySettings.activeDatasourceOnly,onChangeRetentionPeriod:this.onChangeRetentionPeriod,toggleStarredTabAsFirstTab:this.toggleStarredTabAsFirstTab,toggleactiveDatasourceOnly:this.toggleActiveDatasourceOnly,deleteRichHistory:o}),icon:"sliders-v-alt"}];return(0,ae.jsx)(me.W,{tabs:c,onClose:n,defaultTab:r,closeIconTooltip:"Close query history"})}}const Li=(0,C.HE)(Oi);var Di;const Ni={initRichHistory:oi.sO,loadRichHistory:oi.TV,loadMoreRichHistory:oi.io,clearRichHistoryResults:oi.Cs,updateHistorySettings:oi.ch,updateHistorySearchFilters:oi.KZ,deleteRichHistory:oi.ik},Hi=(0,S.connect)((function(e,t){let{exploreId:s}=t;const i=e.explore,o=i[s],n=o.richHistorySearchFilters,r=i.richHistorySettings,{datasourceInstance:a}=o,l=null!=r&&r.starredTabAsFirstTab?Fi.Starred:Fi.RichHistory,{richHistory:c,richHistoryTotal:d}=o;return{richHistory:c,richHistoryTotal:d,firstTab:l,activeDatasourceInstance:a.name,richHistorySettings:r,richHistorySearchFilters:n}}),Ni);const $i=Hi((function(e){const t=(0,C.l4)(),[s,i]=(0,o.useState)(t.components.horizontalDrawer.defaultHeight),{richHistory:n,richHistoryTotal:r,width:a,firstTab:l,activeDatasourceInstance:c,exploreId:d,deleteRichHistory:h,initRichHistory:u,loadRichHistory:p,loadMoreRichHistory:g,clearRichHistoryResults:f,richHistorySettings:m,updateHistorySettings:y,richHistorySearchFilters:v,updateHistorySearchFilters:x,onClose:b}=e;return(0,o.useEffect)((()=>{u(),(0,H.ff)("grafana_explore_query_history_opened",{queryHistoryEnabled:$.v.queryHistoryEnabled})}),[u]),m?(0,ae.jsx)(Ae,{width:a,onResize:(e,t,s)=>{i(Number(s.style.height.slice(0,-2)))},children:(0,ae.jsx)(Li,{richHistory:n,richHistoryTotal:r,firstTab:l,activeDatasourceInstance:c,exploreId:d,onClose:b,height:s,deleteRichHistory:h,richHistorySettings:m,richHistorySearchFilters:v,updateHistorySettings:y,updateHistorySearchFilters:x,loadRichHistory:p,loadMoreRichHistory:g,clearRichHistoryResults:f})}):Di||(Di=(0,ae.jsx)("span",{children:"Loading..."}))}));var Pi=s(54761);function Mi(e){const t=(e=>({containerMargin:i.css`
      margin-top: ${e.spacing(2)};
    `}))((0,C.l4)());return(0,ae.jsx)("div",{className:t.containerMargin,children:(0,ae.jsxs)(Pi.Lh,{children:[!e.addQueryRowButtonHidden&&(0,ae.jsx)(Lt.zx,{variant:"secondary","aria-label":"Add row button",onClick:e.onClickAddQueryRowButton,disabled:e.addQueryRowButtonDisabled,icon:"plus",children:"Add query"}),!e.richHistoryRowButtonHidden&&(0,ae.jsx)(Lt.zx,{variant:"secondary","aria-label":"Rich history button",className:(0,i.cx)({"explore-active-button":e.richHistoryButtonActive}),onClick:e.onClickRichHistoryButton,icon:"history",children:"Query history"}),(0,ae.jsx)(Lt.zx,{variant:"secondary","aria-label":"Query inspector button",className:(0,i.cx)({"explore-active-button":e.queryInspectorButtonActive}),onClick:e.onClickQueryInspectorButton,icon:"info-circle",children:"Inspector"})]})})}var Bi=s(41345),Ai=s(42949);const qi=(0,S.connect)((function(e,t){let{exploreId:s}=t;const i=e.explore[s],{loading:o,tableResult:n,range:r}=i;return{loading:!(n&&n.length>0)&&o,tableResult:n,range:r}}),{});class _i extends o.PureComponent{getMainFrame(e){return(null==e?void 0:e.find((e=>{var t,s;return void 0===(null===(t=e.meta)||void 0===t||null===(s=t.custom)||void 0===s?void 0:s.parentRowIndex)})))||(null==e?void 0:e[0])}getTableHeight(){const{tableResult:e}=this.props,t=this.getMainFrame(e);return t&&0!==t.length?Math.max(Math.min(600,35*t.length)+35):200}render(){var e,t;const{loading:s,onCellFilterAdded:i,tableResult:o,width:n,splitOpenFn:r,range:a,ariaLabel:l,timeZone:c}=this.props,d=this.getTableHeight(),h=n-2*z.vc.theme.panelPadding-Ai.QO;let u=o;if(null!==(e=u)&&void 0!==e&&e.length){u=(0,J.SM)({data:u,timeZone:c,theme:z.vc.theme2,replaceVariables:e=>e,fieldConfig:{defaults:{},overrides:[]}});for(const e of u)for(const t of e.fields)t.getLinks=s=>(0,Es.a)({field:t,rowIndex:s.valueRowIndex,splitOpenFn:r,range:a,dataFrame:e})}const p=this.getMainFrame(u),g=null===(t=u)||void 0===t?void 0:t.filter((e=>{var t,s;return void 0!==(null===(t=e.meta)||void 0===t||null===(s=t.custom)||void 0===s?void 0:s.parentRowIndex)}));return(0,ae.jsx)(P.U,{label:"Table",loading:s,isOpen:!0,children:null!=p&&p.length?(0,ae.jsx)(Bi.i,{ariaLabel:l,data:p,subData:g,width:h,height:d,onCellFilterAdded:i}):(0,ae.jsx)(ss,{metaItems:[{value:"0 series returned"}]})})}}const Wi=qi(_i);var Qi=s(5849),Zi=s(60456),Vi=s(6119),Ui=s(71266),Gi=s(2527);function Ki(e){const t=e.dataFrames[0],{dataFrames:s,splitOpenFn:i,exploreId:n,scrollElement:r,topOfViewRef:a,queryResponse:l}=e,c=(0,o.useMemo)((()=>(0,Gi.N)(t)),[t]),{search:d,setSearch:h,spanFindMatches:p}=(0,Ui.R)(null==c?void 0:c.spans),[g,f]=(0,o.useState)(""),[m,y]=(0,o.useState)(""),v=(0,u.v9)((t=>{var s,i;return null!==(s=null===(i=t.explore[e.exploreId])||void 0===i?void 0:i.datasourceInstance)&&void 0!==s?s:void 0}));return c?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(Qi.Z,{navigable:!0,searchValue:d,setSearch:h,spanFindMatches:p,searchBarSuffix:m,setSearchBarSuffix:y,focusedSpanIdForSearch:g,setFocusedSpanIdForSearch:f}),(0,ae.jsx)(P.U,{label:"Trace View",isOpen:!0,children:(0,ae.jsx)(Vi.m,{exploreId:n,dataFrames:s,splitOpenFn:i,scrollElement:r,traceProp:c,spanFindMatches:p,search:d,focusedSpanIdForSearch:g,queryResponse:l,datasource:v,topOfViewRef:a,topOfViewRefType:Zi.l4.Explore})})]}):null}var Yi,Ji,Xi=s(54124);function eo(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var to;!function(e){e[e.RichHistory=0]="RichHistory",e[e.QueryInspector=1]="QueryInspector"}(to||(to={}));class so extends o.PureComponent{constructor(e){super(e),eo(this,"scrollElement",void 0),eo(this,"absoluteTimeUnsubsciber",void 0),eo(this,"topOfViewRef",(0,o.createRef)()),eo(this,"graphEventBus",void 0),eo(this,"logsEventBus",void 0),eo(this,"onChangeTime",(e=>{const{updateTimeRange:t,exploreId:s}=this.props;t({exploreId:s,rawRange:e})})),eo(this,"onClickExample",(e=>{this.props.setQueries(this.props.exploreId,[e])})),eo(this,"onCellFilterAdded",(e=>{const{value:t,key:s,operator:i}=e;i===A.PT&&this.onClickFilterLabel(s,t),i===A.tE&&this.onClickFilterOutLabel(s,t)})),eo(this,"onClickFilterLabel",((e,t)=>{this.onModifyQueries({type:"ADD_FILTER",options:{key:e,value:t}})})),eo(this,"onClickFilterOutLabel",((e,t)=>{this.onModifyQueries({type:"ADD_FILTER_OUT",options:{key:e,value:t}})})),eo(this,"onClickAddQueryRowButton",(()=>{const{exploreId:e,queryKeys:t}=this.props;this.props.addQueryRow(e,t.length)})),eo(this,"onMakeAbsoluteTime",(()=>{const{makeAbsoluteTime:e}=this.props;e()})),eo(this,"onModifyQueries",(e=>{this.props.modifyQueries(this.props.exploreId,e,(async(e,t)=>{const{datasource:s}=e;if(null==s)return e;const i=await(0,N.F)().get(s);return i.modifyQuery?i.modifyQuery(e,t):e}))})),eo(this,"onResize",(e=>{this.props.changeSize(this.props.exploreId,e)})),eo(this,"onStartScanning",(()=>{this.props.scanStart(this.props.exploreId)})),eo(this,"onStopScanning",(()=>{this.props.scanStopAction({exploreId:this.props.exploreId})})),eo(this,"onUpdateTimeRange",(e=>{const{exploreId:t,updateTimeRange:s}=this.props;s({exploreId:t,absoluteRange:e})})),eo(this,"onChangeGraphStyle",(e=>{const{exploreId:t,changeGraphStyle:s}=this.props;s(t,e)})),eo(this,"toggleShowRichHistory",(()=>{this.setState((e=>({openDrawer:e.openDrawer===to.RichHistory?void 0:to.RichHistory})))})),eo(this,"toggleShowQueryInspector",(()=>{this.setState((e=>({openDrawer:e.openDrawer===to.QueryInspector?void 0:to.QueryInspector})))})),eo(this,"onSplitOpen",(e=>async t=>{if(this.props.splitOpen(t),t&&this.props.datasourceInstance){const s=(await(0,N.F)().get(t.datasourceUid)).type,i=this.props.datasourceInstance.uid===k.D?(0,O.get)(this.props.queries,"0.datasource.type"):this.props.datasourceInstance.type,o={origin:"panel",panelType:e,source:i,target:s,exploreId:this.props.exploreId};(0,H.ff)("grafana_explore_split_view_opened",o)}})),eo(this,"memoizedGetNodeGraphDataFrames",(0,w.Z)(W.Ee)),this.state={openDrawer:void 0},this.graphEventBus=e.eventBus.newScopedBus("graph",{onlyLocal:!1}),this.logsEventBus=e.eventBus.newScopedBus("logs",{onlyLocal:!1})}componentDidMount(){this.absoluteTimeUnsubsciber=q.Z.subscribe(Q.QI,this.onMakeAbsoluteTime)}componentWillUnmount(){var e;null===(e=this.absoluteTimeUnsubsciber)||void 0===e||e.unsubscribe()}renderEmptyState(e){return(0,ae.jsx)("div",{className:(0,i.cx)(e),children:Yi||(Yi=(0,ae.jsx)(As,{}))})}renderNoData(){return Ji||(Ji=(0,ae.jsx)(Hs,{}))}renderGraphPanel(e){const{graphResult:t,absoluteRange:s,timeZone:i,queryResponse:o,loading:n,theme:r,graphStyle:a,showFlameGraph:l}=this.props,c=parseInt(r.spacing(2).slice(0,-2),10),d=(0,ae.jsx)(pe,{graphStyle:a,onChangeGraphStyle:this.onChangeGraphStyle});return(0,ae.jsx)(P.U,{label:d,loading:n,isOpen:!0,children:(0,ae.jsx)(le,{graphStyle:a,data:t,height:l?180:400,width:e-c,absoluteRange:s,onChangeTime:this.onUpdateTimeRange,timeZone:i,annotations:o.annotations,splitOpenFn:this.onSplitOpen("graph"),loadingState:o.state,anchorToZero:!1,eventBus:this.graphEventBus})})}renderTablePanel(e){const{exploreId:t,timeZone:s}=this.props;return(0,ae.jsx)(Wi,{ariaLabel:j.wl.pages.Explore.General.table,width:e,exploreId:t,onCellFilterAdded:this.onCellFilterAdded,timeZone:s,splitOpenFn:this.onSplitOpen("table")})}renderLogsPanel(e){const{exploreId:t,syncedTimes:s,theme:i,queryResponse:o}=this.props,n=parseInt(i.spacing(2).slice(0,-2),10);return(0,ae.jsx)(Ns,{exploreId:t,loadingState:o.state,syncedTimes:s,width:e-n,onClickFilterLabel:this.onClickFilterLabel,onClickFilterOutLabel:this.onClickFilterOutLabel,onStartScanning:this.onStartScanning,onStopScanning:this.onStopScanning,scrollElement:this.scrollElement,eventBus:this.logsEventBus,splitOpenFn:this.onSplitOpen("logs")})}renderNodeGraphPanel(){const{exploreId:e,showTrace:t,queryResponse:s,datasourceInstance:i}=this.props,o=i?null==i?void 0:i.type:"unknown";return(0,ae.jsx)(Gs,{dataFrames:this.memoizedGetNodeGraphDataFrames(s.series),exploreId:e,withTraceView:t,datasourceType:o,splitOpenFn:this.onSplitOpen("nodeGraph")})}renderFlameGraphPanel(){const{queryResponse:e}=this.props;return(0,ae.jsx)(Tt,{dataFrames:e.flameGraphFrames})}renderTraceViewPanel(){const{queryResponse:e,exploreId:t}=this.props,s=e.series.filter((e=>{var t;return"trace"===(null===(t=e.meta)||void 0===t?void 0:t.preferredVisualisationType)}));return s.length&&(0,ae.jsx)(Ki,{exploreId:t,dataFrames:s,splitOpenFn:this.onSplitOpen("traceView"),scrollElement:this.scrollElement,queryResponse:e,topOfViewRef:this.topOfViewRef})}render(){const{datasourceInstance:e,datasourceMissing:t,exploreId:s,graphResult:o,queryResponse:n,isLive:r,theme:l,showMetrics:c,showTable:d,showLogs:h,showTrace:u,showNodeGraph:p,showFlameGraph:g,splitted:f,timeZone:m}=this.props,{openDrawer:y}=this.state,v=(e=>({exploreMain:i.css`
      label: exploreMain;
      // Is needed for some transition animations to work.
      position: relative;
      margin-top: 21px;
    `,button:i.css`
      label: button;
      margin: 1em 4px 0 0;
    `,queryContainer:i.css`
      label: queryContainer;
      // Need to override normal css class and don't want to count on ordering of the classes in html.
      height: auto !important;
      flex: unset !important;
      display: unset !important;
      padding: ${e.spacing(1)};
    `,exploreContainer:i.css`
      display: flex;
      flex: 1 1 auto;
      flex-direction: column;
      padding: ${e.spacing(2)};
      padding-top: 0;
    `,exploreContainerTopnav:i.css`
      padding-top: ${e.spacing(2)};
    `}))(l),x=n&&n.state!==D.Gu.NotStarted,b=y===to.RichHistory,w=!(0,_.X)().queryHistoryAvailable,S=y===to.QueryInspector,R=n.state===D.Gu.Done&&[n.logsFrames,n.graphFrames,n.nodeGraphFrames,n.flameGraphFrames,n.tableFrames,n.traceFrames].every((e=>0===e.length));return(0,ae.jsxs)(M.$,{testId:j.wl.pages.Explore.General.scrollView,autoHeightMin:"100%",scrollRefCallback:e=>this.scrollElement=e||void 0,children:[(0,ae.jsx)(Ct,{exploreId:s,onChangeTime:this.onChangeTime,topOfViewRef:this.topOfViewRef}),t?this.renderEmptyState(v.exploreContainer):null,e&&(0,ae.jsxs)("div",{className:(0,i.cx)(v.exploreContainer,{[v.exploreContainerTopnav]:Boolean($.v.featureToggles.topnav&&!f)}),children:[(0,ae.jsxs)(B.l,{className:v.queryContainer,children:[(0,ae.jsx)(Xs,{exploreId:s}),(0,ae.jsx)(Mi,{addQueryRowButtonDisabled:r,addQueryRowButtonHidden:!1,richHistoryRowButtonHidden:w,richHistoryButtonActive:b,queryInspectorButtonActive:S,onClickAddQueryRowButton:this.onClickAddQueryRowButton,onClickRichHistoryButton:this.toggleShowRichHistory,onClickQueryInspectorButton:this.toggleShowQueryInspector}),(0,ae.jsx)(ii,{exploreId:s})]}),(0,ae.jsx)(L.Z,{onResize:this.onResize,disableHeight:!0,children:e=>{let{width:t}=e;return 0===t?null:(0,ae.jsx)("main",{className:(0,i.cx)(v.exploreMain),style:{width:t},children:(0,ae.jsxs)(a.z4,{children:[x&&(0,ae.jsxs)(ae.Fragment,{children:[c&&o&&(0,ae.jsx)(a.z4,{children:this.renderGraphPanel(t)}),d&&(0,ae.jsx)(a.z4,{children:this.renderTablePanel(t)}),h&&(0,ae.jsx)(a.z4,{children:this.renderLogsPanel(t)}),p&&(0,ae.jsx)(a.z4,{children:this.renderNodeGraphPanel()}),g&&$.v.featureToggles.flameGraph&&(0,ae.jsx)(a.z4,{children:this.renderFlameGraphPanel()}),u&&(0,ae.jsx)(a.z4,{children:this.renderTraceViewPanel()}),R&&(0,ae.jsx)(a.z4,{children:this.renderNoData()})]}),b&&(0,ae.jsx)($i,{width:t,exploreId:s,onClose:this.toggleShowRichHistory}),S&&(0,ae.jsx)(Ue,{exploreId:s,width:t,onClose:this.toggleShowQueryInspector,timeZone:m})]})})}})]})]})}}const io={changeSize:Xi.qN,changeGraphStyle:Xi.Rl,modifyQueries:v.sK,scanStart:v.EA,scanStopAction:v.P4,setQueries:v.KO,updateTimeRange:xt.cD,makeAbsoluteTime:xt.F9,addQueryRow:v.CS,splitOpen:y.bW},oo=(0,S.connect)((function(e,t){let{exploreId:s}=t;const i=e.explore,{syncedTimes:o}=i,n=i[s],r=(0,E.Z)(e.user),{datasourceInstance:a,datasourceMissing:l,queryKeys:c,queries:d,isLive:h,graphResult:u,logsResult:p,showLogs:g,showMetrics:f,showTable:m,showTrace:y,absoluteRange:v,queryResponse:b,showNodeGraph:w,showFlameGraph:S,loading:R,graphStyle:j}=n;return{datasourceInstance:a,datasourceMissing:l,queryKeys:c,queries:d,isLive:h,graphResult:u,logsResult:null!=p?p:void 0,absoluteRange:v,queryResponse:b,syncedTimes:o,timeZone:r,showLogs:g,showMetrics:f,showTable:m,showTrace:y,showNodeGraph:w,showFlameGraph:S,splitted:(0,x.p)(e),loading:R,graphStyle:j}}),io),no=(0,C.HE)(oo(so));var ro=s(30592);function ao(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class lo extends o.PureComponent{constructor(e){super(e),ao(this,"el",null),ao(this,"exploreEvents",void 0),ao(this,"refreshExplore",(e=>{const{exploreId:t,urlQuery:s}=this.props;s!==e&&s!==y.IS[t]&&this.props.refreshExplore(t,s)})),ao(this,"getRef",(e=>{this.el=e})),this.exploreEvents=new R.F,this.state={openDrawer:void 0}}async componentDidMount(){var e,t;const{initialized:s,exploreId:i,initialDatasource:o,initialQueries:n,initialRange:r,panelsState:a,orgId:l}=this.props,c=null!==(e=null===(t=this.el)||void 0===t?void 0:t.offsetWidth)&&void 0!==e?e:0;if(!s){var d;let e,t;if((!n||0===n.length)&&o){if(!(o===k.D||o.uid===k.D)){const{instance:t}=await(0,ro.r_)(l,o);e=t.getRef()}}let s=await(0,I.Z8)(n,e);if(!(0,I._o)(s).noneHaveDatasource&&!(0,I._o)(s).allDatasourceSame)if(z.vc.featureToggles.exploreMixedDatasource)t=await(0,F.ak)().get(k.D);else{const e=s.find((e=>{var t;return null===(t=e.datasource)||void 0===t?void 0:t.uid})).datasource.uid;if(e){t=e;const n=await(0,F.ak)().get(e),r=await(0,F.ak)().get(o);await this.props.importQueries(i,s,r,n),await this.props.stateSave({replace:!0}),s=this.props.initialQueries}}this.props.initializeExplore(i,t||(null===(d=s[0])||void 0===d?void 0:d.datasource)||o,s,r,c,this.exploreEvents,a)}}componentWillUnmount(){this.exploreEvents.removeAllListeners()}componentDidUpdate(e){this.refreshExplore(e.urlQuery)}render(){const{theme:e,split:t,exploreId:s,initialized:o,eventBus:n}=this.props,r=(e=>({explore:i.css`
      display: flex;
      flex: 1 1 auto;
      flex-direction: column;
      & + & {
        border-left: 1px dotted ${e.colors.border.medium};
      }
    `,exploreSplit:i.css`
      width: 50%;
    `}))(e),a=(0,i.cx)(r.explore,t&&r.exploreSplit);return(0,ae.jsx)("div",{className:a,ref:this.getRef,"data-testid":j.wl.pages.Explore.General.container,children:o&&(0,ae.jsx)(no,{exploreId:s,eventBus:n})})}}const co=(0,w.Z)(I.vP);const ho={initializeExplore:Xi.CK,refreshExplore:Xi.Om,importQueries:v.GJ,stateSave:y.og},uo=(0,S.connect)((function(e,t){var s;const i=(0,I.J5)(t.urlQuery),o=(0,E.Z)(e.user),n=(0,E.i)(e.user),{datasource:r,queries:a,range:l,panelsState:c}=i||{},d=r||T.Z.get((0,I.I$)(e.user.orgId)),h=l?co(l,o,n):(0,I.OQ)(o,I.UI,n);return{initialized:null===(s=e.explore[t.exploreId])||void 0===s?void 0:s.initialized,initialDatasource:d,initialQueries:a,initialRange:h,panelsState:c,orgId:e.user.orgId}}),ho),po=(0,C.HE)(uo(lo)),go={pageScrollbarWrapper:i.css`
    width: 100%;
    flex-grow: 1;
    min-height: 0;
  `,exploreWrapper:i.css`
    display: flex;
    height: 100%;
  `};const fo=()=>{const e=(0,d.q)("explore"),t=(0,u.v9)((e=>{var t,s,i;return[null===(t=e.explore.left.datasourceInstance)||void 0===t?void 0:t.name,null===(s=e.explore.right)||void 0===s||null===(i=s.datasourceInstance)||void 0===i?void 0:i.name].filter(h.f)}));document.title=`${e.main.text} - ${t.join(" | ")} - ${g.c.AppTitle}`},mo=function(e){fo();const t=(0,u.I0)(),s=e.queryParams,{keybindings:i,chrome:h,config:g}=(0,l.p)(),m=(0,d.q)("explore"),{get:v}=(0,f.K)(),{warning:x}=(0,c.iG)(),w=(0,r.R9)(),S=(0,o.useRef)(w.eventBus.newScopedBus("explore",{onlyLocal:!1}));(0,o.useEffect)((()=>{h.update({sectionNav:m.node})}),[h,m]),(0,o.useEffect)((()=>{i.setupTimeRangeBindings(!1)}),[i]),(0,o.useEffect)((()=>{g.featureToggles.correlations?v.execute():t((0,y.CL)([]))}),[]),(0,o.useEffect)((()=>{v.value?t((0,y.CL)(v.value)):v.error&&(t((0,y.CL)([])),x("Could not load correlations.","Correlations data could not be loaded, DataLinks may have partial data."))}),[v.value,v.error,t,x]),(0,o.useEffect)((()=>{y.IS.left=void 0,y.IS.right=void 0;const e=n.E1.getSearchObject();return(e.from||e.to)&&n.E1.partial({from:void 0,to:void 0},!0),()=>{t((0,y.WK)())}}),[]);const R=Boolean(s.left)&&Boolean(s.right);return(0,ae.jsxs)("div",{className:go.pageScrollbarWrapper,children:[(0,ae.jsx)(b,{exploreIdLeft:p.K.left,exploreIdRight:p.K.right}),(0,ae.jsxs)("div",{className:go.exploreWrapper,children:[(0,ae.jsx)(a.z4,{style:"page",children:(0,ae.jsx)(po,{split:R,exploreId:p.K.left,urlQuery:s.left,eventBus:S.current})}),R&&(0,ae.jsx)(a.z4,{style:"page",children:(0,ae.jsx)(po,{split:R,exploreId:p.K.right,urlQuery:s.right,eventBus:S.current})})]})]})}},37744:(e,t,s)=>{s.d(t,{F:()=>n,p:()=>o});var i=s(64850);const o=e=>Boolean(e.explore[i.Kd.left]&&e.explore[i.Kd.right]),n=e=>t=>t.explore[e]},13677:(e,t,s)=>{s.d(t,{Z:()=>o});var i=s(68404);const o=function(e,t){var s=(0,i.useRef)((function(){}));(0,i.useEffect)((function(){s.current=e})),(0,i.useEffect)((function(){if(null!==t){var e=setInterval((function(){return s.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},64421:(e,t,s)=>{function i(e){for(var t=arguments.length,s=Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(s.length?" "+s.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function o(e){return!!e&&!!e[Q]}function n(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var s=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return s===Object||"function"==typeof s&&Function.toString.call(s)===Z}(e)||Array.isArray(e)||!!e[W]||!!(null===(t=e.constructor)||void 0===t?void 0:t[W])||u(e)||p(e))}function r(e,t,s){void 0===s&&(s=!1),0===a(e)?(s?Object.keys:V)(e).forEach((function(i){s&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(s,i){return t(i,s,e)}))}function a(e){var t=e[Q];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:u(e)?2:p(e)?3:0}function l(e,t){return 2===a(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){return 2===a(e)?e.get(t):e[t]}function d(e,t,s){var i=a(e);2===i?e.set(t,s):3===i?(e.delete(t),e.add(s)):e[t]=s}function h(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function u(e){return B&&e instanceof Map}function p(e){return A&&e instanceof Set}function g(e){return e.o||e.t}function f(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=U(e);delete t[Q];for(var s=V(t),i=0;i<s.length;i++){var o=s[i],n=t[o];!1===n.writable&&(n.writable=!0,n.configurable=!0),(n.get||n.set)&&(t[o]={configurable:!0,writable:!0,enumerable:n.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function m(e,t){return void 0===t&&(t=!1),v(e)||o(e)||!n(e)||(a(e)>1&&(e.set=e.add=e.clear=e.delete=y),Object.freeze(e),t&&r(e,(function(e,t){return m(t,!0)}),!0)),e}function y(){i(2)}function v(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function x(e){var t=G[e];return t||i(18,e),t}function b(){return P}function w(e,t){t&&(x("Patches"),e.u=[],e.s=[],e.v=t)}function S(e){R(e),e.p.forEach(C),e.p=null}function R(e){e===P&&(P=e.l)}function j(e){return P={p:[],l:P,h:e,m:!0,_:0}}function C(e){var t=e[Q];0===t.i||1===t.i?t.j():t.O=!0}function z(e,t){t._=t.p.length;var s=t.p[0],o=void 0!==e&&e!==s;return t.h.g||x("ES5").S(t,e,o),o?(s[Q].P&&(S(t),i(4)),n(e)&&(e=T(t,e),t.l||k(t,e)),t.u&&x("Patches").M(s[Q].t,e,t.u,t.s)):e=T(t,s,[]),S(t),t.u&&t.v(t.u,t.s),e!==_?e:void 0}function T(e,t,s){if(v(t))return t;var i=t[Q];if(!i)return r(t,(function(o,n){return I(e,i,t,o,n,s)}),!0),t;if(i.A!==e)return t;if(!i.P)return k(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var o=4===i.i||5===i.i?i.o=f(i.k):i.o;r(3===i.i?new Set(o):o,(function(t,n){return I(e,i,o,t,n,s)})),k(e,o,!1),s&&e.u&&x("Patches").R(i,s,e.u,e.s)}return i.o}function I(e,t,s,i,r,a){if(o(r)){var c=T(e,r,a&&t&&3!==t.i&&!l(t.D,i)?a.concat(i):void 0);if(d(s,i,c),!o(c))return;e.m=!1}if(n(r)&&!v(r)){if(!e.h.F&&e._<1)return;T(e,r),t&&t.A.l||k(e,r)}}function k(e,t,s){void 0===s&&(s=!1),e.h.F&&e.m&&m(t,s)}function F(e,t){var s=e[Q];return(s?g(s):e)[t]}function E(e,t){if(t in e)for(var s=Object.getPrototypeOf(e);s;){var i=Object.getOwnPropertyDescriptor(s,t);if(i)return i;s=Object.getPrototypeOf(s)}}function O(e){e.P||(e.P=!0,e.l&&O(e.l))}function L(e){e.o||(e.o=f(e.t))}function D(e,t,s){var i=u(t)?x("MapSet").N(t,s):p(t)?x("MapSet").T(t,s):e.g?function(e,t){var s=Array.isArray(e),i={i:s?1:0,A:t?t.A:b(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=i,n=K;s&&(o=[i],n=Y);var r=Proxy.revocable(o,n),a=r.revoke,l=r.proxy;return i.k=l,i.j=a,l}(t,s):x("ES5").J(t,s);return(s?s.A:b()).p.push(i),i}function N(e){return o(e)||i(22,e),function e(t){if(!n(t))return t;var s,i=t[Q],o=a(t);if(i){if(!i.P&&(i.i<4||!x("ES5").K(i)))return i.t;i.I=!0,s=H(t,o),i.I=!1}else s=H(t,o);return r(s,(function(t,o){i&&c(i.t,t)===o||d(s,t,e(o))})),3===o?new Set(s):s}(e)}function H(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return f(e)}s.d(t,{ZP:()=>te});var $,P,M="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),B="undefined"!=typeof Map,A="undefined"!=typeof Set,q="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,_=M?Symbol.for("immer-nothing"):(($={})["immer-nothing"]=!0,$),W=M?Symbol.for("immer-draftable"):"__$immer_draftable",Q=M?Symbol.for("immer-state"):"__$immer_state",Z=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),V="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,U=Object.getOwnPropertyDescriptors||function(e){var t={};return V(e).forEach((function(s){t[s]=Object.getOwnPropertyDescriptor(e,s)})),t},G={},K={get:function(e,t){if(t===Q)return e;var s=g(e);if(!l(s,t))return function(e,t,s){var i,o=E(t,s);return o?"value"in o?o.value:null===(i=o.get)||void 0===i?void 0:i.call(e.k):void 0}(e,s,t);var i=s[t];return e.I||!n(i)?i:i===F(e.t,t)?(L(e),e.o[t]=D(e.A.h,i,e)):i},has:function(e,t){return t in g(e)},ownKeys:function(e){return Reflect.ownKeys(g(e))},set:function(e,t,s){var i=E(g(e),t);if(null==i?void 0:i.set)return i.set.call(e.k,s),!0;if(!e.P){var o=F(g(e),t),n=null==o?void 0:o[Q];if(n&&n.t===s)return e.o[t]=s,e.D[t]=!1,!0;if(h(s,o)&&(void 0!==s||l(e.t,t)))return!0;L(e),O(e)}return e.o[t]===s&&"number"!=typeof s&&(void 0!==s||t in e.o)||(e.o[t]=s,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==F(e.t,t)||t in e.t?(e.D[t]=!1,L(e),O(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var s=g(e),i=Reflect.getOwnPropertyDescriptor(s,t);return i?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:s[t]}:i},defineProperty:function(){i(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){i(12)}},Y={};r(K,(function(e,t){Y[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Y.deleteProperty=function(e,t){return Y.set.call(this,e,t,void 0)},Y.set=function(e,t,s){return K.set.call(this,e[0],t,s,e[0])};var J=function(){function e(e){var t=this;this.g=q,this.F=!0,this.produce=function(e,s,o){if("function"==typeof e&&"function"!=typeof s){var r=s;s=e;var a=t;return function(e){var t=this;void 0===e&&(e=r);for(var i=arguments.length,o=Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return a.produce(e,(function(e){var i;return(i=s).call.apply(i,[t,e].concat(o))}))}}var l;if("function"!=typeof s&&i(6),void 0!==o&&"function"!=typeof o&&i(7),n(e)){var c=j(t),d=D(t,e,void 0),h=!0;try{l=s(d),h=!1}finally{h?S(c):R(c)}return"undefined"!=typeof Promise&&l instanceof Promise?l.then((function(e){return w(c,o),z(e,c)}),(function(e){throw S(c),e})):(w(c,o),z(l,c))}if(!e||"object"!=typeof e){if(void 0===(l=s(e))&&(l=e),l===_&&(l=void 0),t.F&&m(l,!0),o){var u=[],p=[];x("Patches").M(e,l,u,p),o(u,p)}return l}i(21,e)},this.produceWithPatches=function(e,s){if("function"==typeof e)return function(s){for(var i=arguments.length,o=Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return t.produceWithPatches(s,(function(t){return e.apply(void 0,[t].concat(o))}))};var i,o,n=t.produce(e,s,(function(e,t){i=e,o=t}));return"undefined"!=typeof Promise&&n instanceof Promise?n.then((function(e){return[e,i,o]})):[n,i,o]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){n(e)||i(8),o(e)&&(e=N(e));var t=j(this),s=D(this,e,void 0);return s[Q].C=!0,R(t),s},t.finishDraft=function(e,t){var s=(e&&e[Q]).A;return w(s,t),z(void 0,s)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!q&&i(20),this.g=e},t.applyPatches=function(e,t){var s;for(s=t.length-1;s>=0;s--){var i=t[s];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}s>-1&&(t=t.slice(s+1));var n=x("Patches").$;return o(e)?n(e,t):this.produce(e,(function(e){return n(e,t)}))},e}(),X=new J,ee=X.produce;X.produceWithPatches.bind(X),X.setAutoFreeze.bind(X),X.setUseProxies.bind(X),X.applyPatches.bind(X),X.createDraft.bind(X),X.finishDraft.bind(X);const te=ee}}]);
//# sourceMappingURL=explore.b496d7ef0dc6bf242b8e.js.map